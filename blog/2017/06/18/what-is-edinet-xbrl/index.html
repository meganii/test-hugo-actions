<!DOCTYPE html>
<html ⚡ lang='ja' class="text-gray-800"><head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1">
    <meta name="theme-color" content="#2196f3">
    <meta name="description" content="EDINETとは？  Electronic Disclosure for Investor&amp;rsquo;s NETworkの略 EDINETは、金融庁により運用されている「金融商品取引法に基づく有価証券報告書等の開示書類に関する電子開示システム」 2008年のリニューアルで、財務諸表をXBRL形式による提出が義務付けられた ">

<meta property="og:title" content="EDINETとXBRLとは何か？Pythonで財務諸表のデータを取得する - SIS Lab">
<meta property="og:type" content="article">
<meta property="og:url" content="https://www.meganii.com/blog/2017/06/18/what-is-edinet-xbrl/">
<meta property="og:image" content="https://images-fe.ssl-images-amazon.com/images/I/41Nyynhmv5L._SL160_.jpg">
<meta property="og:site_name" content="SIS Lab">
<meta property="og:description" content="EDINETとは？  Electronic Disclosure for Investor&amp;rsquo;s NETworkの略 EDINETは、金融庁により運用されている「金融商品取引法に基づく有価証券報告書等の開示書類に関する電子開示システム」 2008年のリニューアルで、財務諸表をXBRL形式による提出が義務付けられた ">
<meta property="og:locale" content="ja_JP">

<meta name="twitter:card" content="summary" />
<meta name="twitter:site" content="SIS Lab">
<meta name="twitter:url" content="https://www.meganii.com/blog/2017/06/18/what-is-edinet-xbrl/">
<meta name="twitter:title" content="EDINETとXBRLとは何か？Pythonで財務諸表のデータを取得する - SIS Lab">
<meta name="twitter:description" content="EDINETとは？  Electronic Disclosure for Investor&amp;rsquo;s NETworkの略 EDINETは、金融庁により運用されている「金融商品取引法に基づく有価証券報告書等の開示書類に関する電子開示システム」 2008年のリニューアルで、財務諸表をXBRL形式による提出が義務付けられた ">
<meta name="twitter:image" content="https://images-fe.ssl-images-amazon.com/images/I/41Nyynhmv5L._SL160_.jpg">

<meta property="fb:app_id" content="385471528156440" />

    <meta http-equiv="x-dns-prefetch-control" content="on">
    <link rel="preconnect dns-prefetch" href="//cdn.ampproject.org" crossorigin>
    <link rel="preconnect dns-prefetch" href="//pagead2.googlesyndication.com" crossorigin>
    <link rel="preconnect dns-prefetch" href="//fonts.gstatic.com" crossorigin>
    <link rel="preconnect dns-prefetch" href="//fonts.googleapis.com" crossorigin>
    <link rel="preconnect dns-prefetch" href="//googleads.g.doubleclick.net" crossorigin>
    <link rel="preconnect dns-prefetch" href="//stats.g.doubleclick.net" crossorigin>
    <link rel="preconnect dns-prefetch" href="//static.doubleclick.net" crossorigin>
    <link rel="preconnect dns-prefetch" href="//tpc.googlesyndication.com" crossorigin>
    <link rel="preconnect dns-prefetch" href="//res.cloudinary.com" crossorigin>
    <link rel="preconnect dns-prefetch" href="//www.google-analytics.com" crossorigin>
    <link rel="preconnect dns-prefetch" href="//adservice.google.com" crossorigin>
    <link rel="preconnect dns-prefetch" href="//m.addthis.com" crossorigin>
    <link rel="preload" as="script" href="https://cdn.ampproject.org/v0.js">
    <script async src="https://cdn.ampproject.org/v0.js"></script>
    <script async custom-element="amp-sidebar" src="https://cdn.ampproject.org/v0/amp-sidebar-0.1.js"></script>
    
    
    <script async custom-element="amp-analytics" src="https://cdn.ampproject.org/v0/amp-analytics-0.1.js"></script>
    <script async custom-element="amp-ad" src="https://cdn.ampproject.org/v0/amp-ad-0.1.js"></script>
    
    
    <script async custom-element="amp-addthis" src="https://cdn.ampproject.org/v0/amp-addthis-0.1.js"></script>
    
    <link rel="manifest" href="https://www.meganii.com/manifest.json">
    <script async custom-element="amp-install-serviceworker" src="https://cdn.ampproject.org/v0/amp-install-serviceworker-0.1.js"></script>


    
  
    
    
    
    <style amp-custom>/*!normalize.css v8.0.1 | MIT License | github.com/necolas/normalize.css*/html{line-height:1.15;-webkit-text-size-adjust:100%}body{margin:0}main{display:block}h1{font-size:2em;margin:.67em 0}a{background-color:transparent}strong{font-weight:bolder}img{border-style:none}button{font-family:inherit;font-size:100%;line-height:1.15;margin:0}button{overflow:visible}button{text-transform:none}button,[type=button]{-webkit-appearance:button}button::-moz-focus-inner,[type=button]::-moz-focus-inner{border-style:none;padding:0}button:-moz-focusring,[type=button]:-moz-focusring{outline:1px dotted ButtonText}summary{display:list-item}template{display:none}[hidden]{display:none}blockquote,h1,h2,h3,h4,figure,p{margin:0}button{background-color:transparent;background-image:none;padding:0}button:focus{outline:1px dotted;outline:5px auto -webkit-focus-ring-color}ol,ul{list-style:none;margin:0;padding:0}html{font-family:system-ui,-apple-system,BlinkMacSystemFont,segoe ui,Roboto,helvetica neue,Arial,noto sans,sans-serif,apple color emoji,segoe ui emoji,segoe ui symbol,noto color emoji;line-height:1.5}*,::before,::after{box-sizing:border-box;border-width:0;border-style:solid;border-color:#e0e0e0}img{border-style:solid}button,[role=button]{cursor:pointer}h1,h2,h3,h4{font-size:inherit;font-weight:inherit}a{color:inherit;text-decoration:inherit}button{padding:0;line-height:inherit;color:inherit}img,svg,embed{display:block;vertical-align:middle}img{max-width:100%;height:auto}.post p{margin-top:1rem;margin-bottom:1rem}.post h2{font-size:1.25rem;border-bottom-width:2px;border-color:#e0e0e0;margin-top:1.5rem;padding-bottom:.25rem}.post h3{font-size:1.125rem;border-left-width:4px;padding-left:1rem;margin-top:1rem}.post h4{font-size:1.125rem;margin-top:1rem}.post pre{margin-top:1rem;margin-bottom:1rem;padding:1.5rem;overflow:auto;background-color:#f8f8f8}.post p>code{font-size:.875rem;margin:0;padding-top:.25rem;padding-bottom:.25rem;padding-left:.5rem;padding-right:.5rem;border-radius:.25rem;background-color:#f8f8f8}.post a{text-decoration:underline}.post ol,ul{list-style-position:inside;padding-left:1.25rem;padding-top:1rem}.post ol>li{list-style-type:decimal;margin-top:.25rem}.post ul>li{list-style-type:disc;margin-top:.25rem}.post ol li ol,.post ul li ul,.post ol li ul{margin-top:-1rem}.post li li{list-style-type:circle}.post blockquote{background-color:#f8f8f8;margin-top:.75rem;padding:1rem}amp-img.contain img{-o-object-fit:contain;object-fit:contain}.container{width:100%}@media(min-width:640px){.container{max-width:640px}}@media(min-width:768px){.container{max-width:768px}}@media(min-width:1024px){.container{max-width:1024px}}@media(min-width:1280px){.container{max-width:1280px}}.bg-transparent{background-color:transparent}.bg-gray-200{background-color:#eee}.bg-gray-700{background-color:#616161}.hover\:bg-gray-500:hover{background-color:#9e9e9e}.border-gray-100{border-color:#f8f8f8}.border-gray-200{border-color:#eee}.hover\:border-transparent:hover{border-color:transparent}.rounded{border-radius:.25rem}.border-none{border-style:none}.border{border-width:1px}.border-t{border-top-width:1px}.block{display:block}.inline-block{display:inline-block}.inline{display:inline}.flex{display:flex}.hidden{display:none}.flex-col{flex-direction:column}.flex-wrap{flex-wrap:wrap}.items-center{align-items:center}.justify-end{justify-content:flex-end}.justify-center{justify-content:center}.justify-between{justify-content:space-between}.flex-1{flex:1 1 0%}.flex-grow{flex-grow:1}.clearfix:after{content:"";display:table;clear:both}.font-semibold{font-weight:600}.font-bold{font-weight:700}.h-4{height:1rem}.h-24{height:6rem}.h-56{height:14rem}.h-64{height:16rem}.h-full{height:100%}.leading-normal{line-height:1.5}.leading-relaxed{line-height:1.625}.leading-loose{line-height:2}.m-4{margin:1rem}.my-2{margin-top:.5rem;margin-bottom:.5rem}.my-4{margin-top:1rem;margin-bottom:1rem}.mx-4{margin-left:1rem;margin-right:1rem}.mx-12{margin-left:3rem;margin-right:3rem}.mx-auto{margin-left:auto;margin-right:auto}.mt-1{margin-top:.25rem}.mr-1{margin-right:.25rem}.mt-2{margin-top:.5rem}.mr-2{margin-right:.5rem}.mb-2{margin-bottom:.5rem}.ml-2{margin-left:.5rem}.ml-3{margin-left:.75rem}.mt-4{margin-top:1rem}.ml-4{margin-left:1rem}.mt-8{margin-top:2rem}.mb-8{margin-bottom:2rem}.min-h-screen{min-height:100vh}.opacity-100{opacity:1}.hover\:opacity-75:hover{opacity:.75}.p-1{padding:.25rem}.p-3{padding:.75rem}.p-4{padding:1rem}.px-1{padding-left:.25rem;padding-right:.25rem}.py-2{padding-top:.5rem;padding-bottom:.5rem}.px-4{padding-left:1rem;padding-right:1rem}.pt-3{padding-top:.75rem}.fixed{position:fixed}.absolute{position:absolute}.relative{position:relative}.inset-y-auto{top:auto;bottom:auto}.top-0{top:0}.bottom-0{bottom:0}.left-0{left:0}.fill-current{fill:currentColor}.text-center{text-align:center}.text-right{text-align:right}.text-black{color:#000}.text-white{color:#fff}.text-gray-400{color:#bdbdbd}.text-gray-500{color:#9e9e9e}.text-gray-700{color:#616161}.text-gray-800{color:#424242}.hover\:text-white:hover{color:#fff}.hover\:text-blue-400:hover{color:#63b3ed}.hover\:text-blue-500:hover{color:#4299e1}.text-xs{font-size:.75rem}.text-sm{font-size:.875rem}.text-base{font-size:1rem}.text-xl{font-size:1.25rem}.text-4xl{font-size:2.25rem}.uppercase{text-transform:uppercase}.underline{text-decoration:underline}.no-underline{text-decoration:none}.truncate{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.w-4{width:1rem}.w-4\/5{width:80%}.w-full{width:100%}.transform{--transform-translate-x: 0;--transform-translate-y: 0;--transform-rotate: 0;--transform-skew-x: 0;--transform-skew-y: 0;--transform-scale-x: 1;--transform-scale-y: 1;transform:translateX(var(--transform-translate-x)) translateY(var(--transform-translate-y)) rotate(var(--transform-rotate)) skewX(var(--transform-skew-x)) skewY(var(--transform-skew-y)) scaleX(var(--transform-scale-x)) scaleY(var(--transform-scale-y))}.duration-200{transition-duration:200ms}@media(min-width:640px){.sm\:block{display:block}.sm\:flex{display:flex}.sm\:hidden{display:none}.sm\:mx-4{margin-left:1rem;margin-right:1rem}.sm\:mx-12{margin-left:3rem;margin-right:3rem}.sm\:mt-0{margin-top:0}.sm\:px-2{padding-left:.5rem;padding-right:.5rem}.sm\:w-auto{width:auto}}@media(min-width:768px){.md\:m-4{margin:1rem}.md\:mx-12{margin-left:3rem;margin-right:3rem}.md\:mx-auto{margin-left:auto;margin-right:auto}}@media(min-width:1024px){.lg\:flex{display:flex}.lg\:flex-auto{flex:1 1 auto}.lg\:flex-none{flex:none}.lg\:mx-2{margin-left:.5rem;margin-right:.5rem}.lg\:my-4{margin-top:1rem;margin-bottom:1rem}.lg\:mx-40{margin-left:10rem;margin-right:10rem}.lg\:mx-auto{margin-left:auto;margin-right:auto}.lg\:px-2{padding-left:.5rem;padding-right:.5rem}.lg\:py-4{padding-top:1rem;padding-bottom:1rem}.lg\:w-1\/5{width:20%}.lg\:w-2\/5{width:40%}}</style>

  
    

    <link rel="apple-touch-icon" type="image/png" href="/images/icons/apple-touch-icon-180x180.png">
    <link rel="icon" type="image/png" href="/images/icons/icon-192x192.png">

    <style amp-boilerplate>body{-webkit-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-moz-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-ms-animation:-amp-start 8s steps(1,end) 0s 1 normal both;animation:-amp-start 8s steps(1,end) 0s 1 normal both}@-webkit-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-moz-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-ms-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-o-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}</style><noscript><style amp-boilerplate>body{-webkit-animation:none;-moz-animation:none;-ms-animation:none;animation:none}</style></noscript>
    
<script type="application/ld+json">
  {
    "@context": "http://schema.org",
    "@type": "BlogPosting",
    "mainEntityOfPage": "https://www.meganii.com/blog/2017/06/18/what-is-edinet-xbrl/",
    "headline": "EDINETとXBRLとは何か？Pythonで財務諸表のデータを取得する",
    "datePublished": "2017-06-18T21:54:26JST",
    "dateModified": "2020-04-29T13:39:53JST",
    "description": "EDINETとは？  Electronic Disclosure for Investor\u0026rsquo;s NETworkの略 EDINETは、金融庁により運用されている「金融商品取引法に基づく有価証券報告書等の開示書類に関する電子開示システム」 2008年のリニューアルで、財務諸表をXBRL形式による提出が義務付けられた ",
    "author": {
      "@type": "Person",
      "name": "meganii"
    },
    "publisher": {
      "@type": "Organization",
      "name": "SIS Lab",
      "logo": {
        "@type": "ImageObject",
        "url": "https://www.meganii.com/images/site-logo.png",
        "width": 600,
        "height": 60
      }
    },
    "image": {
      "@type": "ImageObject",
      "url": "https:\/\/images-fe.ssl-images-amazon.com\/images\/I\/41Nyynhmv5L._SL160_.jpg"
    }
  }
</script>

    <link rel="canonical" href="https://www.meganii.com/blog/2017/06/18/what-is-edinet-xbrl/">
    <title>EDINETとXBRLとは何か？Pythonで財務諸表のデータを取得する - SIS Lab</title>
</head><body>
  
    
  <amp-analytics config="https://www.googletagmanager.com/amp.json?id=GTM-T5DJZ8Q&gtm.url=SOURCE_URL" data-credentials="include"></amp-analytics>
  
  
  <div class="container mx-auto flex flex-col min-h-screen"><header class="w-full p-4">
    
    <nav class="flex items-center justify-between flex-wrap">
        <a href="https://www.meganii.com/" class="flex items-center text-gray-700 font-bold">
            SIS Lab
        </a>
        <div class="block sm:hidden">
            <button role="button" aria-label="open menu" on="tap:nav.toggle" tabindex="0" id="nav-open" class="flex items-center text-gray-500 hover:text-blue-500">
                <svg class="fill-current h-4 w-4" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
                    <title>Menu</title>
                    <path d="M0 3h20v2H0V3zm0 6h20v2H0V9zm0 6h20v2H0v-2z" />
                </svg>
            </button>
            <button id="nav-close" class="hidden flex items-center text-gray-700 hover:text-blue-500" role="button" aria-label="close menu" on="tap:nav.toggle" tabindex="0">
                <svg class="fill-current h-4 w-4" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
                    <title>Menu Close</title>
                    <polygon points="11 9 22 9 22 11 11 11 11 22 9 22 9 11 -2 11 -2 9 9 9 9 -2 11 -2"
                        transform="rotate(45 10 10)" />
                </svg>
            </button>
        </div>
        <ul id="nav-menu" class="w-full flex-grow sm:flex items-center sm:w-auto hidden sm:block justify-end list-reset mt-2 sm:mt-0">
            
            
            <li><a class="inline-block text-gray-500 sm:px-2 hover:text-blue-400" href="https://www.meganii.com/category/tech/">Tech</a></li>
            
            <li><a class="inline-block text-gray-500 sm:px-2 hover:text-blue-400" href="https://www.meganii.com/category/life/">Life</a></li>
            
            <li><a class="inline-block text-gray-500 sm:px-2 hover:text-blue-400" href="https://www.meganii.com/category/activity/">Activity</a></li>
            
            <li><a class="inline-block text-gray-500 sm:px-2 hover:text-blue-400" href="https://www.meganii.com/category/travel/">Travel</a></li>
            
            <li><a class="inline-block text-gray-500 sm:px-2 hover:text-blue-400" href="https://www.meganii.com/category/stationery/">Stationery</a></li>
            
            <li><a class="inline-block text-gray-500 sm:px-2 hover:text-blue-400" href="https://www.meganii.com/category/book/">Book</a></li>
            

        </ul>
    </nav>
</header>

<amp-sidebar id="nav" layout="nodisplay" side="right">
    <svg class="text-right fill-current h-4 w-4" tabindex="0" role="button" aria-label="close menu" on="tap:nav.toggle" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
        <title>Menu Close</title>
        <polygon points="11 9 22 9 22 11 11 11 11 22 9 22 9 11 -2 11 -2 9 9 9 9 -2 11 -2"
            transform="rotate(45 10 10)" />
    </svg>
    <ul class="ns">
        
        <li><a href="https://www.meganii.com/category/tech/">Tech</a></li>
        
        <li><a href="https://www.meganii.com/category/life/">Life</a></li>
        
        <li><a href="https://www.meganii.com/category/activity/">Activity</a></li>
        
        <li><a href="https://www.meganii.com/category/travel/">Travel</a></li>
        
        <li><a href="https://www.meganii.com/category/stationery/">Stationery</a></li>
        
        <li><a href="https://www.meganii.com/category/book/">Book</a></li>
        
    </ul>
  </amp-sidebar><main class="flex-1 sm:mx-4 md:mx-12 lg:mx-40">
<article class="mx-4 sm:mx-12">
    <div class="text-sm"><ol>
  
    
  
    
  
<li class="inline">
  
    <a class="underline" href="https://www.meganii.com/">SIS Lab</a>
  
</li>
<li class="inline">></li>
  
<li class="inline">
  
    <a class="underline" href="https://www.meganii.com/blog/">Blog</a>
  
</li>
<li class="inline">></li>
  
<li class="inline active:text-black">
  EDINETとXBRLとは何か？Pythonで財務諸表のデータを取得する
</li>
</ol>

</div>
    <section class="">
        <h1 class="text-4xl mt-4">EDINETとXBRLとは何か？Pythonで財務諸表のデータを取得する</h1>
        <div class="text-sm">
            <span class="mr-1">更新日:2020.04.29</span>
            <span class="">作成日:2017.06.18</span>
        </div>
        <div class="text-sm mt-1">
          
          <a class="no-underline" href="https://www.meganii.com/tags/edinet/"><span class="mr-1 mt-1 p-1 text-white bg-gray-700 rounded">#EDINET</span></a>
          
          <a class="no-underline" href="https://www.meganii.com/tags/fintech/"><span class="mr-1 mt-1 p-1 text-white bg-gray-700 rounded">#FinTech</span></a>
          
          <a class="no-underline" href="https://www.meganii.com/tags/python/"><span class="mr-1 mt-1 p-1 text-white bg-gray-700 rounded">#Python</span></a>
          
        </div>
        <div class="post leading-loose mt-2">
            <h2 id="edinetとは">EDINETとは？</h2>
<ul>
<li>Electronic Disclosure for Investor&rsquo;s NETworkの略</li>
<li>EDINETは、金融庁により運用されている「金融商品取引法に基づく有価証券報告書等の開示書類に関する電子開示システム」</li>
<li>2008年のリニューアルで、財務諸表をXBRL形式による提出が義務付けられた</li>
</ul>
<p><amp-ad
media="(max-width: 480px)"
width="100vw"
height=320
type="adsense"
data-ad-client="ca-pub-5340212676785058"
data-ad-slot="4566541958"
data-auto-format="rspv"
data-full-width>
<div overflow></div>
</amp-ad>
<amp-ad
media="(min-width: 481px)"
layout="fixed-height"
height=200
type="adsense"
data-ad-client="ca-pub-5340212676785058"
data-ad-slot="4566541958">
</amp-ad></p>
<h2 id="xbrlとは">XBRLとは?</h2>
<ul>
<li>eXtensible Business Reporting Languageの略</li>
<li>財務諸表データの表現用途に特化したXMLベースの言語</li>
<li>米国の企業情報開示システムEDGARでも採用されていて、財務諸表電子化のグローバルスタンダードな規格</li>
</ul>
<h3 id="xbrlの特徴">XBRLの特徴</h3>
<p>財務諸表は会計基準・会計規則と密に関係するため、国・地域・業種が異なれば、財務諸表の構成も大きく違うという性質がある。</p>
<ul>
<li>財務諸表の多様性に対応するため、XBRLは柔軟な拡張性を備えている</li>
<li>XML Schema, XLinkといったXMLの技術を用いて、財務データをタクソノミ(Taxsonomy)とインスタンス(Instance)に二分して表現している</li>
<li>XBRLのおかげで、XBRLデータを分析システム等に直接取り込むことが可能となり、事務負担の軽減やより高度な財務分析を行うことができる</li>
</ul>
<p>タクソノミ・・・財務報告の電子的ひな形
インスタンス・・・財務報告内容そのもの</p>
<h2 id="edinetからダウンロードしたxbrl-xsd-xmlについて">EDINETからダウンロードした.xbrl, .xsd, .xmlについて</h2>
<ul>
<li>.xbrlファイルは「報告書インスタンス」であり、財務諸表の値が記録されている</li>
<li>残りの.xsd, .xmlファイルは、「企業別タクソノミ」</li>
</ul>
<h2 id="xbrlから流動資産を抽出するサンプルプログラム">XBRLから流動資産を抽出するサンプルプログラム</h2>
<p><a href="http://qiita.com/shima_x/items/c1955743cb5784505ac9">EDINETからXBRLファイルをダウンロード(個人的メモ) - Qiita</a>を参考に、まずはPython3に書き換えた。</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#4e9a06">&#39;&#39;&#39;
</span><span style="color:#4e9a06">XBRLから流動資産を抽出するサンプルプログラム
</span><span style="color:#4e9a06">&#39;&#39;&#39;</span>

<span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">os</span>
<span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">re</span>
<span style="color:#204a87;font-weight:bold">from</span> <span style="color:#000">collections</span> <span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">defaultdict</span>
<span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">xml.etree.ElementTree</span> <span style="color:#204a87;font-weight:bold">as</span> <span style="color:#000">ET</span>
<span style="color:#204a87;font-weight:bold">from</span> <span style="color:#000">xbrl</span> <span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">XBRLParser</span>
<span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">pandas</span> <span style="color:#204a87;font-weight:bold">as</span> <span style="color:#000">pd</span>
<span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">requests</span>


<span style="color:#204a87;font-weight:bold">class</span> <span style="color:#000">XbrlParser</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">XBRLParser</span><span style="color:#000;font-weight:bold">):</span>
    <span style="color:#204a87;font-weight:bold">def</span> <span style="color:#000">__init__</span><span style="color:#000;font-weight:bold">(</span><span style="color:#3465a4">self</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">xbrl_filename</span><span style="color:#000;font-weight:bold">):</span>
        <span style="color:#3465a4">self</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">xbrl_filename</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">xbrl_filename</span>
        <span style="color:#3465a4">self</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">base_filename</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">xbrl_filename</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">replace</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;.xbrl&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#39;&#39;</span><span style="color:#000;font-weight:bold">)</span>

    <span style="color:#204a87;font-weight:bold">def</span> <span style="color:#000">parse_xbrl</span><span style="color:#000;font-weight:bold">(</span><span style="color:#3465a4">self</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">namespaces</span><span style="color:#000;font-weight:bold">):</span>
        <span style="color:#000">result</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">defaultdict</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87">dict</span><span style="color:#000;font-weight:bold">)</span>
        <span style="color:#000">result</span><span style="color:#000;font-weight:bold">[</span><span style="color:#4e9a06">&#39;facts&#39;</span><span style="color:#000;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#3465a4">self</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">get_facts_info</span><span style="color:#000;font-weight:bold">()</span>

        <span style="color:#000">label_file_name</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#3465a4">self</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">base_filename</span><span style="color:#ce5c00;font-weight:bold">+</span><span style="color:#4e9a06">&#39;_lab.xml&#39;</span>
        <span style="color:#000">ET</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">register_namespace</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#39;http://www.w3.org/2005/Atom&#39;</span><span style="color:#000;font-weight:bold">)</span>
        <span style="color:#000">labels</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">ET</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">parse</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">label_file_name</span><span style="color:#000;font-weight:bold">)</span>

        <span style="color:#8f5902;font-style:italic"># get enterprise taxonomy</span>
        <span style="color:#000">extended_labels</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#3465a4">self</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">get_label_info</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">namespaces</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">labels</span><span style="color:#000;font-weight:bold">)</span>

        <span style="color:#8f5902;font-style:italic"># get base link</span>
        <span style="color:#000">base_labels</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#3465a4">self</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">get_base_label_info</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">namespaces</span><span style="color:#000;font-weight:bold">)</span>

        <span style="color:#000">extended_labels</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">extended_labels</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">append</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">base_labels</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">ignore_index</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#3465a4">True</span><span style="color:#000;font-weight:bold">)</span>
        <span style="color:#000">result</span><span style="color:#000;font-weight:bold">[</span><span style="color:#4e9a06">&#39;labels&#39;</span><span style="color:#000;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">extended_labels</span>
        <span style="color:#000">result</span><span style="color:#000;font-weight:bold">[</span><span style="color:#4e9a06">&#39;presentation&#39;</span><span style="color:#000;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#3465a4">self</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">get_presentation_info</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">namespaces</span><span style="color:#000;font-weight:bold">)</span>
        <span style="color:#204a87;font-weight:bold">return</span> <span style="color:#000">result</span>

    <span style="color:#204a87;font-weight:bold">def</span> <span style="color:#000">get_base_label_info</span><span style="color:#000;font-weight:bold">(</span><span style="color:#3465a4">self</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">namespaces</span><span style="color:#000;font-weight:bold">):</span>
        <span style="color:#000">base_file_path</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">os</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">getcwd</span><span style="color:#000;font-weight:bold">()</span><span style="color:#ce5c00;font-weight:bold">+</span><span style="color:#4e9a06">&#39;/base_labels/&#39;</span>
        <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#204a87;font-weight:bold">not</span> <span style="color:#000">os</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">path</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">exists</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">base_file_path</span><span style="color:#000;font-weight:bold">):</span>
            <span style="color:#000">os</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">mkdir</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">base_file_path</span><span style="color:#000;font-weight:bold">)</span>
        <span style="color:#000">base_labels</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#3465a4">None</span>

        <span style="color:#8f5902;font-style:italic"># get common taxonomy</span>
        <span style="color:#204a87;font-weight:bold">for</span> <span style="color:#000">link_base</span> <span style="color:#204a87;font-weight:bold">in</span> <span style="color:#3465a4">self</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">get_link_base</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">namespaces</span><span style="color:#000;font-weight:bold">):</span>
            <span style="color:#000">file_path</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">base_file_path</span> <span style="color:#ce5c00;font-weight:bold">+</span> <span style="color:#000">link_base</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">strip</span><span style="color:#000;font-weight:bold">()</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">split</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;/&#39;</span><span style="color:#000;font-weight:bold">)[</span><span style="color:#ce5c00;font-weight:bold">-</span><span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">]</span>

            <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000">os</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">path</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">exists</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">file_path</span><span style="color:#000;font-weight:bold">):</span>
                <span style="color:#000">tmp_base_labels</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">pd</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">read_csv</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">file_path</span><span style="color:#000;font-weight:bold">)</span>
            <span style="color:#204a87;font-weight:bold">else</span><span style="color:#000;font-weight:bold">:</span>
                <span style="color:#204a87;font-weight:bold">print</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;creating &#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">link_base</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#39;base label data...&#39;</span><span style="color:#000;font-weight:bold">)</span>
                <span style="color:#000">response</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">requests</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">get</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">link_base</span><span style="color:#000;font-weight:bold">)</span>
                <span style="color:#000">html</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">response</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">text</span>
                <span style="color:#000">ET</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">register_namespace</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#39;http://www.xbrl.org/2003/linkbase&#39;</span><span style="color:#000;font-weight:bold">)</span>
                <span style="color:#000">labels</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">ET</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">fromstring</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">html</span><span style="color:#000;font-weight:bold">)</span>
                <span style="color:#000">labels</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">labels</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">findall</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;.//link:labelLink&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">namespaces</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000">namespaces</span><span style="color:#000;font-weight:bold">)[</span><span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">]</span>

                <span style="color:#000">tmp_base_labels</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#3465a4">self</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">get_label_info</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">namespaces</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">labels</span><span style="color:#000;font-weight:bold">)</span>
                <span style="color:#000">tmp_base_labels</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">to_csv</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">file_path</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">index</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#3465a4">False</span><span style="color:#000;font-weight:bold">)</span>
            <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000">base_labels</span> <span style="color:#204a87;font-weight:bold">is</span> <span style="color:#204a87;font-weight:bold">not</span> <span style="color:#3465a4">None</span><span style="color:#000;font-weight:bold">:</span>
                <span style="color:#000">base_labels</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">base_labels</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">append</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">tmp_base_labels</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">ignore_index</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#3465a4">True</span><span style="color:#000;font-weight:bold">)</span>
            <span style="color:#204a87;font-weight:bold">else</span><span style="color:#000;font-weight:bold">:</span>
                <span style="color:#000">base_labels</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">tmp_base_labels</span>
        <span style="color:#204a87;font-weight:bold">return</span> <span style="color:#000">base_labels</span>

    <span style="color:#204a87;font-weight:bold">def</span> <span style="color:#000">concat_dictionary</span><span style="color:#000;font-weight:bold">(</span><span style="color:#3465a4">self</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">dict1</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">dict2</span><span style="color:#000;font-weight:bold">):</span>
        <span style="color:#204a87;font-weight:bold">for</span> <span style="color:#000">key</span> <span style="color:#204a87;font-weight:bold">in</span> <span style="color:#000">dict1</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">keys</span><span style="color:#000;font-weight:bold">():</span>
            <span style="color:#000">dict1</span><span style="color:#000;font-weight:bold">[</span><span style="color:#000">key</span><span style="color:#000;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">dict1</span><span style="color:#000;font-weight:bold">[</span><span style="color:#000">key</span><span style="color:#000;font-weight:bold">]</span><span style="color:#ce5c00;font-weight:bold">+</span><span style="color:#000">dict2</span><span style="color:#000;font-weight:bold">[</span><span style="color:#000">key</span><span style="color:#000;font-weight:bold">]</span>
        <span style="color:#204a87;font-weight:bold">return</span> <span style="color:#000">dict1</span>

    <span style="color:#204a87;font-weight:bold">def</span> <span style="color:#000">get_facts_info</span><span style="color:#000;font-weight:bold">(</span><span style="color:#3465a4">self</span><span style="color:#000;font-weight:bold">):</span>
        <span style="color:#4e9a06">&#34;&#34;&#34;
</span><span style="color:#4e9a06">        return(element_id, amount, context_ref, unit_ref, decimals)
</span><span style="color:#4e9a06">        &#34;&#34;&#34;</span>
        <span style="color:#8f5902;font-style:italic"># parse xbrl file</span>
        <span style="color:#000">xbrl</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">XBRLParser</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">parse</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87">open</span><span style="color:#000;font-weight:bold">(</span><span style="color:#3465a4">self</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">xbrl_filename</span><span style="color:#000;font-weight:bold">))</span> <span style="color:#8f5902;font-style:italic"># beautiful soup type object</span>
        <span style="color:#000">facts_dict</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">defaultdict</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87">list</span><span style="color:#000;font-weight:bold">)</span>

        <span style="color:#8f5902;font-style:italic">#print xbrl</span>
        <span style="color:#000">name_space</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#39;jp*&#39;</span>
        <span style="color:#204a87;font-weight:bold">for</span> <span style="color:#000">node</span> <span style="color:#204a87;font-weight:bold">in</span> <span style="color:#000">xbrl</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">find_all</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">name</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000">re</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">compile</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">name_space</span><span style="color:#ce5c00;font-weight:bold">+</span><span style="color:#4e9a06">&#39;:*&#39;</span><span style="color:#000;font-weight:bold">)):</span>
            <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#4e9a06">&#39;xsi:nil&#39;</span> <span style="color:#204a87;font-weight:bold">in</span> <span style="color:#000">node</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">attrs</span><span style="color:#000;font-weight:bold">:</span>
                <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000">node</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">attrs</span><span style="color:#000;font-weight:bold">[</span><span style="color:#4e9a06">&#39;xsi:nil&#39;</span><span style="color:#000;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">==</span> <span style="color:#4e9a06">&#39;true&#39;</span><span style="color:#000;font-weight:bold">:</span>
                    <span style="color:#204a87;font-weight:bold">continue</span>

            <span style="color:#000">facts_dict</span><span style="color:#000;font-weight:bold">[</span><span style="color:#4e9a06">&#39;element_id&#39;</span><span style="color:#000;font-weight:bold">]</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">append</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">node</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">name</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">replace</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;:&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#39;_&#39;</span><span style="color:#000;font-weight:bold">))</span>
            <span style="color:#000">facts_dict</span><span style="color:#000;font-weight:bold">[</span><span style="color:#4e9a06">&#39;amount&#39;</span><span style="color:#000;font-weight:bold">]</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">append</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">node</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">string</span><span style="color:#000;font-weight:bold">)</span>

            <span style="color:#000">facts_dict</span><span style="color:#000;font-weight:bold">[</span><span style="color:#4e9a06">&#39;context_ref&#39;</span><span style="color:#000;font-weight:bold">]</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">append</span><span style="color:#000;font-weight:bold">(</span><span style="color:#3465a4">self</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">get_attrib_value</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">node</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#39;contextref&#39;</span><span style="color:#000;font-weight:bold">))</span>
            <span style="color:#000">facts_dict</span><span style="color:#000;font-weight:bold">[</span><span style="color:#4e9a06">&#39;unit_ref&#39;</span><span style="color:#000;font-weight:bold">]</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">append</span><span style="color:#000;font-weight:bold">(</span><span style="color:#3465a4">self</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">get_attrib_value</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">node</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#39;unitref&#39;</span><span style="color:#000;font-weight:bold">))</span>
            <span style="color:#000">facts_dict</span><span style="color:#000;font-weight:bold">[</span><span style="color:#4e9a06">&#39;decimals&#39;</span><span style="color:#000;font-weight:bold">]</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">append</span><span style="color:#000;font-weight:bold">(</span><span style="color:#3465a4">self</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">get_attrib_value</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">node</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#39;decimals&#39;</span><span style="color:#000;font-weight:bold">))</span>
        <span style="color:#204a87;font-weight:bold">return</span> <span style="color:#000">pd</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">DataFrame</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">facts_dict</span><span style="color:#000;font-weight:bold">)</span>

    <span style="color:#204a87;font-weight:bold">def</span> <span style="color:#000">get_attrib_value</span><span style="color:#000;font-weight:bold">(</span><span style="color:#3465a4">self</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">node</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">attrib</span><span style="color:#000;font-weight:bold">):</span>
        <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000">attrib</span> <span style="color:#204a87;font-weight:bold">in</span> <span style="color:#000">node</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">attrs</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">keys</span><span style="color:#000;font-weight:bold">():</span>
            <span style="color:#204a87;font-weight:bold">return</span> <span style="color:#000">node</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">attrs</span><span style="color:#000;font-weight:bold">[</span><span style="color:#000">attrib</span><span style="color:#000;font-weight:bold">]</span>
        <span style="color:#204a87;font-weight:bold">else</span><span style="color:#000;font-weight:bold">:</span>
            <span style="color:#204a87;font-weight:bold">return</span> <span style="color:#3465a4">None</span>

    <span style="color:#204a87;font-weight:bold">def</span> <span style="color:#000">get_link_base</span><span style="color:#000;font-weight:bold">(</span><span style="color:#3465a4">self</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">namespaces</span><span style="color:#000;font-weight:bold">):</span>
        <span style="color:#000">label_file_name</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#3465a4">self</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">base_filename</span><span style="color:#ce5c00;font-weight:bold">+</span><span style="color:#4e9a06">&#39;.xsd&#39;</span>
        <span style="color:#000">ET</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">register_namespace</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#39;http://www.w3.org/2001/XMLSchema&#39;</span><span style="color:#000;font-weight:bold">)</span>
        <span style="color:#000">labels</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">ET</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">parse</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">label_file_name</span><span style="color:#000;font-weight:bold">)</span>
        <span style="color:#000">linkbases</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">labels</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">findall</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;.//link:linkbaseRef&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">namespaces</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000">namespaces</span><span style="color:#000;font-weight:bold">)</span>

        <span style="color:#000">link_base</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">[]</span>
        <span style="color:#204a87;font-weight:bold">for</span> <span style="color:#000">link_node</span> <span style="color:#204a87;font-weight:bold">in</span> <span style="color:#000">linkbases</span><span style="color:#000;font-weight:bold">:</span>
            <span style="color:#000">link_href</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">link_node</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">attrib</span><span style="color:#000;font-weight:bold">[</span><span style="color:#4e9a06">&#39;{&#39;</span><span style="color:#ce5c00;font-weight:bold">+</span><span style="color:#000">namespaces</span><span style="color:#000;font-weight:bold">[</span><span style="color:#4e9a06">&#39;xlink&#39;</span><span style="color:#000;font-weight:bold">]</span><span style="color:#ce5c00;font-weight:bold">+</span><span style="color:#4e9a06">&#39;}href&#39;</span><span style="color:#000;font-weight:bold">]</span>
            <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#4e9a06">&#39;_lab.xml&#39;</span> <span style="color:#204a87;font-weight:bold">in</span> <span style="color:#000">link_href</span> <span style="color:#204a87;font-weight:bold">and</span> <span style="color:#4e9a06">&#39;http://&#39;</span> <span style="color:#204a87;font-weight:bold">in</span> <span style="color:#000">link_href</span><span style="color:#000;font-weight:bold">:</span>
                <span style="color:#000">link_base</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">append</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">link_href</span><span style="color:#000;font-weight:bold">)</span>
        <span style="color:#204a87;font-weight:bold">return</span> <span style="color:#000">link_base</span>

    <span style="color:#204a87;font-weight:bold">def</span> <span style="color:#000">get_label_info</span><span style="color:#000;font-weight:bold">(</span><span style="color:#3465a4">self</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">namespaces</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">labels</span><span style="color:#000;font-weight:bold">):</span>
        <span style="color:#4e9a06">&#34;&#34;&#34;
</span><span style="color:#4e9a06">        return(element_id, label_string, lang, label_role, href)
</span><span style="color:#4e9a06">        &#34;&#34;&#34;</span>
        <span style="color:#000">label_dict</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">defaultdict</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87">list</span><span style="color:#000;font-weight:bold">)</span>

        <span style="color:#8f5902;font-style:italic">#label_file_name = self.base_filename+&#39;_lab.xml&#39;</span>
        <span style="color:#8f5902;font-style:italic">#ET.register_namespace(&#39;&#39;,&#39;http://www.w3.org/2005/Atom&#39;)</span>
        <span style="color:#8f5902;font-style:italic">#labels = ET.parse(label_file_name)</span>

        <span style="color:#204a87;font-weight:bold">for</span> <span style="color:#000">label_node</span> <span style="color:#204a87;font-weight:bold">in</span> <span style="color:#000">labels</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">findall</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;.//link:label&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">namespaces</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000">namespaces</span><span style="color:#000;font-weight:bold">):</span>
            <span style="color:#000">label_label</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">label_node</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">attrib</span><span style="color:#000;font-weight:bold">[</span><span style="color:#4e9a06">&#39;{&#39;</span><span style="color:#ce5c00;font-weight:bold">+</span><span style="color:#000">namespaces</span><span style="color:#000;font-weight:bold">[</span><span style="color:#4e9a06">&#39;xlink&#39;</span><span style="color:#000;font-weight:bold">]</span><span style="color:#ce5c00;font-weight:bold">+</span><span style="color:#4e9a06">&#39;}label&#39;</span><span style="color:#000;font-weight:bold">]</span>

            <span style="color:#204a87;font-weight:bold">for</span> <span style="color:#000">labelArc_node</span> <span style="color:#204a87;font-weight:bold">in</span> <span style="color:#000">labels</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">findall</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;.//link:labelArc&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">namespaces</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000">namespaces</span><span style="color:#000;font-weight:bold">):</span>
                <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000">label_label</span> <span style="color:#ce5c00;font-weight:bold">!=</span> <span style="color:#000">labelArc_node</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">attrib</span><span style="color:#000;font-weight:bold">[</span><span style="color:#4e9a06">&#39;{&#39;</span><span style="color:#ce5c00;font-weight:bold">+</span><span style="color:#000">namespaces</span><span style="color:#000;font-weight:bold">[</span><span style="color:#4e9a06">&#39;xlink&#39;</span><span style="color:#000;font-weight:bold">]</span><span style="color:#ce5c00;font-weight:bold">+</span><span style="color:#4e9a06">&#39;}to&#39;</span><span style="color:#000;font-weight:bold">]:</span>
                    <span style="color:#204a87;font-weight:bold">continue</span>

                <span style="color:#204a87;font-weight:bold">for</span> <span style="color:#000">loc_node</span> <span style="color:#204a87;font-weight:bold">in</span> <span style="color:#000">labels</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">findall</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;.//link:loc&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">namespaces</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000">namespaces</span><span style="color:#000;font-weight:bold">):</span>
                    <span style="color:#000">loc_label</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">loc_node</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">attrib</span><span style="color:#000;font-weight:bold">[</span><span style="color:#4e9a06">&#39;{&#39;</span><span style="color:#ce5c00;font-weight:bold">+</span><span style="color:#000">namespaces</span><span style="color:#000;font-weight:bold">[</span><span style="color:#4e9a06">&#39;xlink&#39;</span><span style="color:#000;font-weight:bold">]</span><span style="color:#ce5c00;font-weight:bold">+</span><span style="color:#4e9a06">&#39;}label&#39;</span><span style="color:#000;font-weight:bold">]</span>
                    <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000">loc_label</span> <span style="color:#ce5c00;font-weight:bold">!=</span> <span style="color:#000">labelArc_node</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">attrib</span><span style="color:#000;font-weight:bold">[</span><span style="color:#4e9a06">&#39;{&#39;</span><span style="color:#ce5c00;font-weight:bold">+</span><span style="color:#000">namespaces</span><span style="color:#000;font-weight:bold">[</span><span style="color:#4e9a06">&#39;xlink&#39;</span><span style="color:#000;font-weight:bold">]</span><span style="color:#ce5c00;font-weight:bold">+</span><span style="color:#4e9a06">&#39;}from&#39;</span><span style="color:#000;font-weight:bold">]:</span>
                        <span style="color:#204a87;font-weight:bold">continue</span>

                    <span style="color:#000">lang</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">label_node</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">attrib</span><span style="color:#000;font-weight:bold">[</span><span style="color:#4e9a06">&#39;{&#39;</span><span style="color:#ce5c00;font-weight:bold">+</span><span style="color:#000">namespaces</span><span style="color:#000;font-weight:bold">[</span><span style="color:#4e9a06">&#39;xml&#39;</span><span style="color:#000;font-weight:bold">]</span><span style="color:#ce5c00;font-weight:bold">+</span><span style="color:#4e9a06">&#39;}lang&#39;</span><span style="color:#000;font-weight:bold">]</span>
                    <span style="color:#000">label_role</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">label_node</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">attrib</span><span style="color:#000;font-weight:bold">[</span><span style="color:#4e9a06">&#39;{&#39;</span><span style="color:#ce5c00;font-weight:bold">+</span><span style="color:#000">namespaces</span><span style="color:#000;font-weight:bold">[</span><span style="color:#4e9a06">&#39;xlink&#39;</span><span style="color:#000;font-weight:bold">]</span><span style="color:#ce5c00;font-weight:bold">+</span><span style="color:#4e9a06">&#39;}role&#39;</span><span style="color:#000;font-weight:bold">]</span>
                    <span style="color:#000">href</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">loc_node</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">attrib</span><span style="color:#000;font-weight:bold">[</span><span style="color:#4e9a06">&#39;{&#39;</span><span style="color:#ce5c00;font-weight:bold">+</span><span style="color:#000">namespaces</span><span style="color:#000;font-weight:bold">[</span><span style="color:#4e9a06">&#39;xlink&#39;</span><span style="color:#000;font-weight:bold">]</span><span style="color:#ce5c00;font-weight:bold">+</span><span style="color:#4e9a06">&#39;}href&#39;</span><span style="color:#000;font-weight:bold">]</span>

                    <span style="color:#000">label_dict</span><span style="color:#000;font-weight:bold">[</span><span style="color:#4e9a06">&#39;element_id&#39;</span><span style="color:#000;font-weight:bold">]</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">append</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">href</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">split</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;#&#39;</span><span style="color:#000;font-weight:bold">)[</span><span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">]</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">lower</span><span style="color:#000;font-weight:bold">())</span>
                    <span style="color:#000">label_dict</span><span style="color:#000;font-weight:bold">[</span><span style="color:#4e9a06">&#39;label_string&#39;</span><span style="color:#000;font-weight:bold">]</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">append</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">label_node</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">text</span><span style="color:#000;font-weight:bold">)</span>
                    <span style="color:#000">label_dict</span><span style="color:#000;font-weight:bold">[</span><span style="color:#4e9a06">&#39;lang&#39;</span><span style="color:#000;font-weight:bold">]</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">append</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">lang</span><span style="color:#000;font-weight:bold">)</span>
                    <span style="color:#000">label_dict</span><span style="color:#000;font-weight:bold">[</span><span style="color:#4e9a06">&#39;label_role&#39;</span><span style="color:#000;font-weight:bold">]</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">append</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">label_role</span><span style="color:#000;font-weight:bold">)</span>
                    <span style="color:#000">label_dict</span><span style="color:#000;font-weight:bold">[</span><span style="color:#4e9a06">&#39;href&#39;</span><span style="color:#000;font-weight:bold">]</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">append</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">href</span><span style="color:#000;font-weight:bold">)</span>
        <span style="color:#204a87;font-weight:bold">return</span> <span style="color:#000">pd</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">DataFrame</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">label_dict</span><span style="color:#000;font-weight:bold">)</span>

    <span style="color:#204a87;font-weight:bold">def</span> <span style="color:#000">get_presentation_info</span><span style="color:#000;font-weight:bold">(</span><span style="color:#3465a4">self</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">namespaces</span><span style="color:#000;font-weight:bold">):</span>
        <span style="color:#4e9a06">&#34;&#34;&#34;
</span><span style="color:#4e9a06">        return(element_id, label_string, lang, label_role, href)
</span><span style="color:#4e9a06">        &#34;&#34;&#34;</span>
        <span style="color:#000">type_dict</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">defaultdict</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87">list</span><span style="color:#000;font-weight:bold">)</span>

        <span style="color:#000">label_file_name</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#3465a4">self</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">base_filename</span><span style="color:#ce5c00;font-weight:bold">+</span><span style="color:#4e9a06">&#39;_pre.xml&#39;</span>
        <span style="color:#000">ET</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">register_namespace</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#39;http://www.w3.org/2005/Atom&#39;</span><span style="color:#000;font-weight:bold">)</span>
        <span style="color:#000">types</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">ET</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">parse</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">label_file_name</span><span style="color:#000;font-weight:bold">)</span>

        <span style="color:#204a87;font-weight:bold">for</span> <span style="color:#000">type_link_node</span> <span style="color:#204a87;font-weight:bold">in</span> <span style="color:#000">types</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">findall</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;.//link:presentationLink&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">namespaces</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000">namespaces</span><span style="color:#000;font-weight:bold">):</span>
            <span style="color:#204a87;font-weight:bold">for</span> <span style="color:#000">type_arc_node</span> <span style="color:#204a87;font-weight:bold">in</span> <span style="color:#000">type_link_node</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">findall</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;.//link:presentationArc&#39;</span><span style="color:#000;font-weight:bold">,</span>
                                                        <span style="color:#000">namespaces</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000">namespaces</span><span style="color:#000;font-weight:bold">):</span>
                <span style="color:#000">type_arc_from</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">type_arc_node</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">attrib</span><span style="color:#000;font-weight:bold">[</span><span style="color:#4e9a06">&#39;{&#39;</span><span style="color:#ce5c00;font-weight:bold">+</span><span style="color:#000">namespaces</span><span style="color:#000;font-weight:bold">[</span><span style="color:#4e9a06">&#39;xlink&#39;</span><span style="color:#000;font-weight:bold">]</span><span style="color:#ce5c00;font-weight:bold">+</span><span style="color:#4e9a06">&#39;}from&#39;</span><span style="color:#000;font-weight:bold">]</span>
                <span style="color:#000">type_arc_to</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">type_arc_node</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">attrib</span><span style="color:#000;font-weight:bold">[</span><span style="color:#4e9a06">&#39;{&#39;</span><span style="color:#ce5c00;font-weight:bold">+</span><span style="color:#000">namespaces</span><span style="color:#000;font-weight:bold">[</span><span style="color:#4e9a06">&#39;xlink&#39;</span><span style="color:#000;font-weight:bold">]</span><span style="color:#ce5c00;font-weight:bold">+</span><span style="color:#4e9a06">&#39;}to&#39;</span><span style="color:#000;font-weight:bold">]</span>

                <span style="color:#000">matches</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">0</span>
                <span style="color:#204a87;font-weight:bold">for</span> <span style="color:#000">loc_node</span> <span style="color:#204a87;font-weight:bold">in</span> <span style="color:#000">type_link_node</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">findall</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;.//link:loc&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">namespaces</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#000">namespaces</span><span style="color:#000;font-weight:bold">):</span>
                    <span style="color:#000">loc_label</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">loc_node</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">attrib</span><span style="color:#000;font-weight:bold">[</span><span style="color:#4e9a06">&#39;{&#39;</span><span style="color:#ce5c00;font-weight:bold">+</span><span style="color:#000">namespaces</span><span style="color:#000;font-weight:bold">[</span><span style="color:#4e9a06">&#39;xlink&#39;</span><span style="color:#000;font-weight:bold">]</span><span style="color:#ce5c00;font-weight:bold">+</span><span style="color:#4e9a06">&#39;}label&#39;</span><span style="color:#000;font-weight:bold">]</span>

                    <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000">loc_label</span> <span style="color:#ce5c00;font-weight:bold">==</span> <span style="color:#000">type_arc_from</span><span style="color:#000;font-weight:bold">:</span>
                        <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#4e9a06">&#39;{&#39;</span><span style="color:#ce5c00;font-weight:bold">+</span><span style="color:#000">namespaces</span><span style="color:#000;font-weight:bold">[</span><span style="color:#4e9a06">&#39;xlink&#39;</span><span style="color:#000;font-weight:bold">]</span><span style="color:#ce5c00;font-weight:bold">+</span><span style="color:#4e9a06">&#39;}href&#39;</span> <span style="color:#204a87;font-weight:bold">in</span> <span style="color:#000">loc_node</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">attrib</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">keys</span><span style="color:#000;font-weight:bold">():</span>
                            <span style="color:#000">href_str</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">loc_node</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">attrib</span><span style="color:#000;font-weight:bold">[</span><span style="color:#4e9a06">&#39;{&#39;</span><span style="color:#ce5c00;font-weight:bold">+</span><span style="color:#000">namespaces</span><span style="color:#000;font-weight:bold">[</span><span style="color:#4e9a06">&#39;xlink&#39;</span><span style="color:#000;font-weight:bold">]</span><span style="color:#ce5c00;font-weight:bold">+</span><span style="color:#4e9a06">&#39;}href&#39;</span><span style="color:#000;font-weight:bold">]</span>
                            <span style="color:#000">type_dict</span><span style="color:#000;font-weight:bold">[</span><span style="color:#4e9a06">&#39;from_href&#39;</span><span style="color:#000;font-weight:bold">]</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">append</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">href_str</span><span style="color:#000;font-weight:bold">)</span>
                            <span style="color:#000">type_dict</span><span style="color:#000;font-weight:bold">[</span><span style="color:#4e9a06">&#39;from_element_id&#39;</span><span style="color:#000;font-weight:bold">]</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">append</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">href_str</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">split</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;#&#39;</span><span style="color:#000;font-weight:bold">)[</span><span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">]</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">lower</span><span style="color:#000;font-weight:bold">())</span>
                            <span style="color:#000">matches</span> <span style="color:#ce5c00;font-weight:bold">+=</span> <span style="color:#0000cf;font-weight:bold">1</span>
                    <span style="color:#204a87;font-weight:bold">elif</span> <span style="color:#000">loc_label</span> <span style="color:#ce5c00;font-weight:bold">==</span> <span style="color:#000">type_arc_to</span><span style="color:#000;font-weight:bold">:</span>
                        <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#4e9a06">&#39;{&#39;</span><span style="color:#ce5c00;font-weight:bold">+</span><span style="color:#000">namespaces</span><span style="color:#000;font-weight:bold">[</span><span style="color:#4e9a06">&#39;xlink&#39;</span><span style="color:#000;font-weight:bold">]</span><span style="color:#ce5c00;font-weight:bold">+</span><span style="color:#4e9a06">&#39;}href&#39;</span> <span style="color:#204a87;font-weight:bold">in</span> <span style="color:#000">loc_node</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">attrib</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">keys</span><span style="color:#000;font-weight:bold">():</span>
                            <span style="color:#000">href_str</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">loc_node</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">attrib</span><span style="color:#000;font-weight:bold">[</span><span style="color:#4e9a06">&#39;{&#39;</span><span style="color:#ce5c00;font-weight:bold">+</span><span style="color:#000">namespaces</span><span style="color:#000;font-weight:bold">[</span><span style="color:#4e9a06">&#39;xlink&#39;</span><span style="color:#000;font-weight:bold">]</span><span style="color:#ce5c00;font-weight:bold">+</span><span style="color:#4e9a06">&#39;}href&#39;</span><span style="color:#000;font-weight:bold">]</span>
                            <span style="color:#000">type_dict</span><span style="color:#000;font-weight:bold">[</span><span style="color:#4e9a06">&#39;to_href&#39;</span><span style="color:#000;font-weight:bold">]</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">append</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">href_str</span><span style="color:#000;font-weight:bold">)</span>
                            <span style="color:#000">type_dict</span><span style="color:#000;font-weight:bold">[</span><span style="color:#4e9a06">&#39;to_element_id&#39;</span><span style="color:#000;font-weight:bold">]</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">append</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">href_str</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">split</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;#&#39;</span><span style="color:#000;font-weight:bold">)[</span><span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">]</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">lower</span><span style="color:#000;font-weight:bold">())</span>
                            <span style="color:#000">matches</span> <span style="color:#ce5c00;font-weight:bold">+=</span> <span style="color:#0000cf;font-weight:bold">1</span>
                    <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000">matches</span> <span style="color:#ce5c00;font-weight:bold">==</span> <span style="color:#0000cf;font-weight:bold">2</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#204a87;font-weight:bold">break</span>

                <span style="color:#000">role_id</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">type_link_node</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">attrib</span><span style="color:#000;font-weight:bold">[</span><span style="color:#4e9a06">&#39;{&#39;</span><span style="color:#ce5c00;font-weight:bold">+</span><span style="color:#000">namespaces</span><span style="color:#000;font-weight:bold">[</span><span style="color:#4e9a06">&#39;xlink&#39;</span><span style="color:#000;font-weight:bold">]</span><span style="color:#ce5c00;font-weight:bold">+</span><span style="color:#4e9a06">&#39;}role&#39;</span><span style="color:#000;font-weight:bold">]</span>
                <span style="color:#000">arcrole</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">type_arc_node</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">attrib</span><span style="color:#000;font-weight:bold">[</span><span style="color:#4e9a06">&#39;{&#39;</span><span style="color:#ce5c00;font-weight:bold">+</span><span style="color:#000">namespaces</span><span style="color:#000;font-weight:bold">[</span><span style="color:#4e9a06">&#39;xlink&#39;</span><span style="color:#000;font-weight:bold">]</span><span style="color:#ce5c00;font-weight:bold">+</span><span style="color:#4e9a06">&#39;}arcrole&#39;</span><span style="color:#000;font-weight:bold">]</span>
                <span style="color:#000">order</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#3465a4">self</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">get_xml_attrib_value</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">type_arc_node</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#39;order&#39;</span><span style="color:#000;font-weight:bold">)</span>
                <span style="color:#000">closed</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#3465a4">self</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">get_xml_attrib_value</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">type_arc_node</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#39;closed&#39;</span><span style="color:#000;font-weight:bold">)</span>
                <span style="color:#000">usable</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#3465a4">self</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">get_xml_attrib_value</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">type_arc_node</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#39;usable&#39;</span><span style="color:#000;font-weight:bold">)</span>
                <span style="color:#000">context_element</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#3465a4">self</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">get_xml_attrib_value</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">type_arc_node</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#39;contextElement&#39;</span><span style="color:#000;font-weight:bold">)</span>
                <span style="color:#000">preferred_label</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#3465a4">self</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">get_xml_attrib_value</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">type_arc_node</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#39;preferredLabel&#39;</span><span style="color:#000;font-weight:bold">)</span>

                <span style="color:#000">type_dict</span><span style="color:#000;font-weight:bold">[</span><span style="color:#4e9a06">&#39;role_id&#39;</span><span style="color:#000;font-weight:bold">]</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">append</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">role_id</span><span style="color:#000;font-weight:bold">)</span>
                <span style="color:#000">type_dict</span><span style="color:#000;font-weight:bold">[</span><span style="color:#4e9a06">&#39;arcrole&#39;</span><span style="color:#000;font-weight:bold">]</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">append</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">arcrole</span><span style="color:#000;font-weight:bold">)</span>
                <span style="color:#000">type_dict</span><span style="color:#000;font-weight:bold">[</span><span style="color:#4e9a06">&#39;order&#39;</span><span style="color:#000;font-weight:bold">]</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">append</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">order</span><span style="color:#000;font-weight:bold">)</span>
                <span style="color:#000">type_dict</span><span style="color:#000;font-weight:bold">[</span><span style="color:#4e9a06">&#39;closed&#39;</span><span style="color:#000;font-weight:bold">]</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">append</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">closed</span><span style="color:#000;font-weight:bold">)</span>
                <span style="color:#000">type_dict</span><span style="color:#000;font-weight:bold">[</span><span style="color:#4e9a06">&#39;usable&#39;</span><span style="color:#000;font-weight:bold">]</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">append</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">usable</span><span style="color:#000;font-weight:bold">)</span>
                <span style="color:#000">type_dict</span><span style="color:#000;font-weight:bold">[</span><span style="color:#4e9a06">&#39;context_element&#39;</span><span style="color:#000;font-weight:bold">]</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">append</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">context_element</span><span style="color:#000;font-weight:bold">)</span>
                <span style="color:#000">type_dict</span><span style="color:#000;font-weight:bold">[</span><span style="color:#4e9a06">&#39;preferred_label&#39;</span><span style="color:#000;font-weight:bold">]</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">append</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">preferred_label</span><span style="color:#000;font-weight:bold">)</span>
        <span style="color:#204a87;font-weight:bold">return</span> <span style="color:#000">pd</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">DataFrame</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">type_dict</span><span style="color:#000;font-weight:bold">)</span>

    <span style="color:#204a87;font-weight:bold">def</span> <span style="color:#000">get_xml_attrib_value</span><span style="color:#000;font-weight:bold">(</span><span style="color:#3465a4">self</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">node</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">attrib</span><span style="color:#000;font-weight:bold">):</span>
        <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000">attrib</span> <span style="color:#204a87;font-weight:bold">in</span> <span style="color:#000">node</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">attrib</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">keys</span><span style="color:#000;font-weight:bold">():</span>
            <span style="color:#204a87;font-weight:bold">return</span> <span style="color:#000">node</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">attrib</span><span style="color:#000;font-weight:bold">[</span><span style="color:#000">attrib</span><span style="color:#000;font-weight:bold">]</span>
        <span style="color:#204a87;font-weight:bold">else</span><span style="color:#000;font-weight:bold">:</span>
            <span style="color:#204a87;font-weight:bold">return</span> <span style="color:#3465a4">None</span>

    <span style="color:#204a87;font-weight:bold">def</span> <span style="color:#000">extract_target_data</span><span style="color:#000;font-weight:bold">(</span><span style="color:#3465a4">self</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">df</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">element_id</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#3465a4">None</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">label_string</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#3465a4">None</span><span style="color:#000;font-weight:bold">,</span> \
                                <span style="color:#000">lang</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#3465a4">None</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">label_role</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#3465a4">None</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">href</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#3465a4">None</span><span style="color:#000;font-weight:bold">):</span>
        <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000">element_id</span> <span style="color:#204a87;font-weight:bold">is</span> <span style="color:#204a87;font-weight:bold">not</span> <span style="color:#3465a4">None</span><span style="color:#000;font-weight:bold">:</span>
            <span style="color:#000">df</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">df</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">ix</span><span style="color:#000;font-weight:bold">[</span><span style="color:#000">df</span><span style="color:#000;font-weight:bold">[</span><span style="color:#4e9a06">&#39;element_id&#39;</span><span style="color:#000;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">==</span> <span style="color:#000">element_id</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000;font-weight:bold">:]</span>
        <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000">label_string</span> <span style="color:#204a87;font-weight:bold">is</span> <span style="color:#204a87;font-weight:bold">not</span> <span style="color:#3465a4">None</span><span style="color:#000;font-weight:bold">:</span>
            <span style="color:#000">df</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">df</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">ix</span><span style="color:#000;font-weight:bold">[</span><span style="color:#000">df</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">label_string</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">str</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">contains</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">label_string</span><span style="color:#000;font-weight:bold">),</span> <span style="color:#000;font-weight:bold">:]</span>
        <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000">lang</span> <span style="color:#204a87;font-weight:bold">is</span> <span style="color:#204a87;font-weight:bold">not</span> <span style="color:#3465a4">None</span><span style="color:#000;font-weight:bold">:</span>
            <span style="color:#000">df</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">df</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">ix</span><span style="color:#000;font-weight:bold">[</span><span style="color:#000">df</span><span style="color:#000;font-weight:bold">[</span><span style="color:#4e9a06">&#39;lang&#39;</span><span style="color:#000;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">==</span> <span style="color:#000">lang</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000;font-weight:bold">:]</span>
        <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000">label_role</span> <span style="color:#204a87;font-weight:bold">is</span> <span style="color:#204a87;font-weight:bold">not</span> <span style="color:#3465a4">None</span><span style="color:#000;font-weight:bold">:</span>
            <span style="color:#000">df</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">df</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">ix</span><span style="color:#000;font-weight:bold">[</span><span style="color:#000">df</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">label_role</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">str</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">contains</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">label_role</span><span style="color:#000;font-weight:bold">),</span> <span style="color:#000;font-weight:bold">:]</span>
        <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000">href</span> <span style="color:#204a87;font-weight:bold">is</span> <span style="color:#204a87;font-weight:bold">not</span> <span style="color:#3465a4">None</span><span style="color:#000;font-weight:bold">:</span>
            <span style="color:#000">df</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">df</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">ix</span><span style="color:#000;font-weight:bold">[</span><span style="color:#000">df</span><span style="color:#000;font-weight:bold">[</span><span style="color:#4e9a06">&#39;href&#39;</span><span style="color:#000;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">==</span> <span style="color:#000">href</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000;font-weight:bold">:]</span>
        <span style="color:#204a87;font-weight:bold">return</span> <span style="color:#000">df</span>

    <span style="color:#204a87;font-weight:bold">def</span> <span style="color:#000">gather_descendant</span><span style="color:#000;font-weight:bold">(</span><span style="color:#3465a4">self</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">df</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">parent</span><span style="color:#000;font-weight:bold">):</span>
        <span style="color:#000">children</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">df</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">to_element_id</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">ix</span><span style="color:#000;font-weight:bold">[</span><span style="color:#000">df</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">from_element_id</span> <span style="color:#ce5c00;font-weight:bold">==</span> <span style="color:#000">parent</span><span style="color:#000;font-weight:bold">]</span>
        <span style="color:#204a87;font-weight:bold">return</span> <span style="color:#000">children</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">append</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">children</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">apply</span><span style="color:#000;font-weight:bold">(</span><span style="color:#204a87;font-weight:bold">lambda</span> <span style="color:#000">x</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#3465a4">self</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">gather_descendant</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">df</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">x</span><span style="color:#000;font-weight:bold">)))</span>

    <span style="color:#204a87;font-weight:bold">def</span> <span style="color:#000">get_specific_account_name_info</span><span style="color:#000;font-weight:bold">(</span><span style="color:#3465a4">self</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">dat_fi</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">df_descendant</span><span style="color:#000;font-weight:bold">):</span>
        <span style="color:#000">result</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#3465a4">None</span>
        <span style="color:#204a87;font-weight:bold">for</span> <span style="color:#000">label_id</span> <span style="color:#204a87;font-weight:bold">in</span> <span style="color:#000">df_descendant</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">ix</span><span style="color:#000;font-weight:bold">[:,</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">]</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">values</span><span style="color:#000;font-weight:bold">:</span>
            <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000">result</span> <span style="color:#204a87;font-weight:bold">is</span> <span style="color:#3465a4">None</span><span style="color:#000;font-weight:bold">:</span>
                <span style="color:#000">result</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">dat_fi</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">ix</span><span style="color:#000;font-weight:bold">[</span><span style="color:#000">dat_fi</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">element_id</span> <span style="color:#ce5c00;font-weight:bold">==</span> <span style="color:#000">label_id</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000;font-weight:bold">:]</span>
            <span style="color:#204a87;font-weight:bold">else</span><span style="color:#000;font-weight:bold">:</span>
                <span style="color:#000">result</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">result</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">append</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">dat_fi</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">ix</span><span style="color:#000;font-weight:bold">[</span><span style="color:#000">dat_fi</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">element_id</span> <span style="color:#ce5c00;font-weight:bold">==</span> <span style="color:#000">label_id</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000;font-weight:bold">:],</span>
                                       <span style="color:#000">ignore_index</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#3465a4">True</span><span style="color:#000;font-weight:bold">)</span>
        <span style="color:#204a87;font-weight:bold">return</span> <span style="color:#000">result</span>

<span style="color:#204a87;font-weight:bold">def</span> <span style="color:#000">main</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">namespaces</span><span style="color:#000;font-weight:bold">):</span>
    <span style="color:#000">base_path</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">os</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">getcwd</span><span style="color:#000;font-weight:bold">()</span><span style="color:#ce5c00;font-weight:bold">+</span><span style="color:#4e9a06">&#39;/xbrl_files/&#39;</span>
    <span style="color:#000">_dir</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#39;S100AFWB/XBRL/PublicDoc/&#39;</span>
    <span style="color:#000">xbrl_filename</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">base_path</span><span style="color:#ce5c00;font-weight:bold">+</span><span style="color:#000">_dir</span><span style="color:#ce5c00;font-weight:bold">+</span><span style="color:#4e9a06">&#39;jpcrp030000-asr-001_E05651-000_2017-03-31_01_2017-06-23.xbrl&#39;</span>

    <span style="color:#8f5902;font-style:italic"># get data</span>
    <span style="color:#000">xp</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">XbrlParser</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">xbrl_filename</span><span style="color:#000;font-weight:bold">)</span>

    <span style="color:#204a87;font-weight:bold">print</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;getting data...&#39;</span><span style="color:#000;font-weight:bold">)</span>
    <span style="color:#000">xbrl_persed</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">xp</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">parse_xbrl</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">namespaces</span><span style="color:#000;font-weight:bold">)</span>
    <span style="color:#204a87;font-weight:bold">print</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;done&#39;</span><span style="color:#000;font-weight:bold">)</span>

    <span style="color:#000">df_xbrl_facts</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">xbrl_persed</span><span style="color:#000;font-weight:bold">[</span><span style="color:#4e9a06">&#39;facts&#39;</span><span style="color:#000;font-weight:bold">]</span> <span style="color:#8f5902;font-style:italic"># 金額の定義及び文書情報の定義情報</span>
    <span style="color:#000">df_xbrl_labels</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">xbrl_persed</span><span style="color:#000;font-weight:bold">[</span><span style="color:#4e9a06">&#39;labels&#39;</span><span style="color:#000;font-weight:bold">]</span> <span style="color:#8f5902;font-style:italic"># 名称リンク情報</span>
    <span style="color:#000">df_xbrl_presentation</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">xbrl_persed</span><span style="color:#000;font-weight:bold">[</span><span style="color:#4e9a06">&#39;presentation&#39;</span><span style="color:#000;font-weight:bold">]</span> <span style="color:#8f5902;font-style:italic"># 表示リンク情報</span>

    <span style="color:#8f5902;font-style:italic"># extract labels data</span>
    <span style="color:#000">df_xbrl_labels</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">xp</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">extract_target_data</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">df_xbrl_labels</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">lang</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">&#39;ja&#39;</span><span style="color:#000;font-weight:bold">)</span>
                            <span style="color:#8f5902;font-style:italic">#label_role=&#39;http://www.xbrl.org/2003/role/documentation&#39;)</span>
                            <span style="color:#8f5902;font-style:italic">#label_role=&#39;documentation&#39;)</span>

    <span style="color:#8f5902;font-style:italic"># De-duplication of labels data</span>
    <span style="color:#000">df_xbrl_labels</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">df_xbrl_labels</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">drop_duplicates</span><span style="color:#000;font-weight:bold">()</span>

    <span style="color:#000">dat_fi</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">pd</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">merge</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">df_xbrl_labels</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">df_xbrl_facts</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">on</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">&#39;element_id&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">how</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">&#39;inner&#39;</span><span style="color:#000;font-weight:bold">)</span>

    <span style="color:#8f5902;font-style:italic"># specify duration</span>
    <span style="color:#000">dat_fi_cyi</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">dat_fi</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">ix</span><span style="color:#000;font-weight:bold">[</span><span style="color:#000">dat_fi</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">context_ref</span> <span style="color:#ce5c00;font-weight:bold">==</span> <span style="color:#4e9a06">&#39;CurrentYearInstant&#39;</span><span style="color:#000;font-weight:bold">]</span> <span style="color:#8f5902;font-style:italic"># 当期 時点</span>
    <span style="color:#8f5902;font-style:italic"># 流動資産のelement_idのみ取得</span>
    <span style="color:#000">parent</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">df_xbrl_labels</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">element_id</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">ix</span><span style="color:#000;font-weight:bold">[</span><span style="color:#000">df_xbrl_labels</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">label_string</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">str</span>
                                          <span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">contains</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;^流動資産$&#39;</span><span style="color:#000;font-weight:bold">)]</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">drop_duplicates</span><span style="color:#000;font-weight:bold">()</span>
    <span style="color:#204a87;font-weight:bold">print</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">parent</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#39;</span><span style="color:#4e9a06">\n</span><span style="color:#4e9a06">&#39;</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#8f5902;font-style:italic"># 流動資産のelement_idを表示</span>
    <span style="color:#8f5902;font-style:italic"># B/Sの流動資産に関する情報のみ取得</span>
    <span style="color:#000">parent</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#4e9a06">&#39;jppfs_cor_currentassetsabstract&#39;</span>
    <span style="color:#000">df_xbrl_ps_cbs</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">df_xbrl_presentation</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">ix</span><span style="color:#000;font-weight:bold">[</span><span style="color:#000">df_xbrl_presentation</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">role_id</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">str</span>
                                             <span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">contains</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;rol_ConsolidatedBalanceSheet&#39;</span><span style="color:#000;font-weight:bold">),</span> <span style="color:#000;font-weight:bold">:]</span>
    <span style="color:#8f5902;font-style:italic"># 再帰的に流動資産の子要素以下の要素を取得</span>
    <span style="color:#000">df_descendant</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">xp</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">gather_descendant</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">df_xbrl_ps_cbs</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">parent</span><span style="color:#000;font-weight:bold">)</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">dropna</span><span style="color:#000;font-weight:bold">()</span> <span style="color:#8f5902;font-style:italic"># delete nan</span>
    <span style="color:#8f5902;font-style:italic"># 特定の勘定科目の情報のみ取得</span>
    <span style="color:#000">df_fi_cyi_caa</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">xp</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">get_specific_account_name_info</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">dat_fi_cyi</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">df_descendant</span><span style="color:#000;font-weight:bold">)</span>
    <span style="color:#8f5902;font-style:italic"># ラベルと金額情報のみ表示</span>
    <span style="color:#204a87;font-weight:bold">print</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">df_fi_cyi_caa</span><span style="color:#000;font-weight:bold">[[</span><span style="color:#4e9a06">&#39;label_string&#39;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#39;amount&#39;</span><span style="color:#000;font-weight:bold">]]</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">drop_duplicates</span><span style="color:#000;font-weight:bold">())</span>

<span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000">__name__</span> <span style="color:#ce5c00;font-weight:bold">==</span> <span style="color:#4e9a06">&#39;__main__&#39;</span><span style="color:#000;font-weight:bold">:</span>
    <span style="color:#000">main</span><span style="color:#000;font-weight:bold">({</span>
        <span style="color:#4e9a06">&#39;link&#39;</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#4e9a06">&#39;http://www.xbrl.org/2003/linkbase&#39;</span><span style="color:#000;font-weight:bold">,</span>
        <span style="color:#4e9a06">&#39;xml&#39;</span><span style="color:#000;font-weight:bold">:</span><span style="color:#4e9a06">&#39;http://www.w3.org/XML/1998/namespace&#39;</span><span style="color:#000;font-weight:bold">,</span>
        <span style="color:#4e9a06">&#39;xlink&#39;</span><span style="color:#000;font-weight:bold">:</span><span style="color:#4e9a06">&#39;http://www.w3.org/1999/xlink&#39;</span><span style="color:#000;font-weight:bold">,</span>
        <span style="color:#4e9a06">&#39;xsi&#39;</span><span style="color:#000;font-weight:bold">:</span><span style="color:#4e9a06">&#39;http://www.w3.org/2001/XMLSchema-instance&#39;</span>
        <span style="color:#000;font-weight:bold">})</span>
</code></pre></div><h2 id="参考">参考</h2>
<ul>
<li><a href="https://disclosure.edinet-fsa.go.jp/EKW0EZ0007.html#2_0">EDINET</a></li>
<li><a href="http://qiita.com/MAIMAI816/items/c9baf4a4e27c146df7c6">Xbrlについて調べてみた - Qiita</a></li>
<li><a href="http://qiita.com/shima_x/items/58634a838ab37c3607b5">EDINETのXBRLファイルから情報抽出 - Qiita</a></li>
<li><a href="http://qiita.com/shima_x/items/c1955743cb5784505ac9">EDINETからXBRLファイルをダウンロード(個人的メモ) - Qiita</a></li>
<li>[金融データ解析の基礎 (シリーズ Useful R 8) ] (<a href="https://www.amazon.co.jp/%E9%87%91%E8%9E%8D%E3%83%87%E3%83%BC%E3%82%BF%E8%A7%A3%E6%9E%90%E3%81%AE%E5%9F%BA%E7%A4%8E-%E3%82%B7%E3%83%AA%E3%83%BC%E3%82%BA-Useful-R-8/dp/4320123719/ref=as_li_ss_tl?s=books&amp;ie=UTF8&amp;qid=1498907653&amp;sr=1-1&amp;keywords=%E9%87%91%E8%9E%8D%E3%83%87%E3%83%BC%E3%82%BF%E8%A7%A3%E6%9E%90%E3%81%AE%E5%9F%BA%E7%A4%8E&amp;linkCode=ll1&amp;tag=meganii-22&amp;linkId=d737c50c30bfb1b8803fd9e5b649a9bf">https://www.amazon.co.jp/%E9%87%91%E8%9E%8D%E3%83%87%E3%83%BC%E3%82%BF%E8%A7%A3%E6%9E%90%E3%81%AE%E5%9F%BA%E7%A4%8E-%E3%82%B7%E3%83%AA%E3%83%BC%E3%82%BA-Useful-R-8/dp/4320123719/ref=as_li_ss_tl?s=books&amp;ie=UTF8&amp;qid=1498907653&amp;sr=1-1&amp;keywords=%E9%87%91%E8%9E%8D%E3%83%87%E3%83%BC%E3%82%BF%E8%A7%A3%E6%9E%90%E3%81%AE%E5%9F%BA%E7%A4%8E&amp;linkCode=ll1&amp;tag=meganii-22&amp;linkId=d737c50c30bfb1b8803fd9e5b649a9bf</a>)</li>
</ul>
<p></p>
<div class="m-4 relative border border-grey-light rounded
            trasition opacity-100 hover:opacity-75 duration-200 hover:duration-200
            md:m-4 md:mx-auto
            lg:flex lg:my-4 lg:mx-auto">
    <div class="h-56 relative rounded lg:flex-none lg:w-2/5 lg:px-2 lg:py-4 lg:mx-2">
        <amp-img class="contain" src="https://m.media-amazon.com/images/I/41Nyynhmv5L.jpg" alt="金融データ解析の基礎 (シリーズ Useful R 8)" layout="fill" />
    </div>
    <div class="p-4 flex flex-col justify-between leading-normal">
        <div class="mb-8 px-1">
            <div>金融データ解析の基礎 (シリーズ Useful R 8)</div><div>出版社：共立出版</div><div>著者:<span class="ml-3">高柳 慎一</span><span class="ml-3">井口 亮</span><span class="ml-3">水木 栄</span><span class="ml-3">金 明哲</span></div><div>発売日: 2014.08.09</div></div>
    </div>
    <a href="https://www.amazon.co.jp/dp/4320123719?tag=meganii-22&amp;linkCode=ogi&amp;th=1&amp;psc=1" class="block absolute inset-y-auto w-full h-full"></a>
</div>
        </div>
    </section>

    <div>
        <div class="">
  <span class="text-xs">スポンサーリンク</span>
  <div>
    <amp-ad
        media="(max-width: 480px)"
        width="100vw"
        height=320
        type="adsense"
        data-ad-client="ca-pub-5340212676785058"
        data-ad-slot="7368951150"
        data-auto-format="rspv"
        data-full-width>
        <div overflow></div>
      </amp-ad>
  </div>
  <div class="lg:flex">
    <div class="lg:flex-auto">
      <amp-ad
        media="(min-width: 481px)"
        layout="fixed-height"
        height=320
        type="adsense"
        data-ad-client="ca-pub-5340212676785058"
        data-ad-slot="7368951150">
      </amp-ad>
    </div>
    <div class="lg:flex-auto">
      <amp-ad
        media="(min-width: 481px)"
        layout="fixed-height"
        height=320
        type="adsense"
        data-ad-client="ca-pub-5340212676785058"
        data-ad-slot="7368951150">
      </amp-ad>
    </div>
  </div>
</div>

    </div>

    <div class="mt-8">
        <amp-addthis
    media="(max-width: 480px)"
    width="320"
    height="92"
    data-pub-id="ra-5d8fda9f5accd108"
    data-widget-id="pzg6"
    data-widget-type="inline"
    data-url="https://www.meganii.com/blog/2017/06/18/what-is-edinet-xbrl/"
></amp-addthis>
<amp-addthis
    media="(min-width: 481px)"
    width="600"
    height="92"
    data-pub-id="ra-5d8fda9f5accd108"
    data-widget-id="pzg6"
    data-widget-type="inline"
    data-url="https://www.meganii.com/blog/2017/06/18/what-is-edinet-xbrl/"
></amp-addthis>
    </div>

    
    
    
    
    <section class="">
        <h4 class="">Related contents</h4>
        
        <article class="m-4 pt-3 relative border-t border-grey-light rounded
        trasition opacity-100 hover:opacity-75 duration-200 hover:duration-200
        md:m-4 md:mx-auto
        lg:flex lg:my-4 lg:mx-auto">
            <div class="h-24 relative rounded lg:flex-none lg:w-1/5 lg:px-2 lg:py-4 lg:mx-2">
                <amp-img class="contain" alt="Eyecatch" media="" layout="fill"
                    src="/images/hugo_s.png">
                </amp-img>
            </div>
            <div class="p-4 flex flex-col justify-between leading-normal">
                <div class="px-1">
                    <p class="text-sm text-grey-dark flex items-center">TECH</p>
                    <p class="text-grey-dark">2016.09.06</p>
                    <div class="text-black text-xl mb-2">Hugoで人気記事を表示するためJSONを返すAPIサーバを作りData-driven Contentを試してみた</div>
                </div>
            </div>
            <a href="https://www.meganii.com/blog/2016/09/06/hugo-data-driven-content-for-polupar-posts/" class="block absolute top-0 left-0 w-full h-full"></a>
        </article>
        
        <article class="m-4 pt-3 relative border-t border-grey-light rounded
        trasition opacity-100 hover:opacity-75 duration-200 hover:duration-200
        md:m-4 md:mx-auto
        lg:flex lg:my-4 lg:mx-auto">
            <div class="h-24 relative rounded lg:flex-none lg:w-1/5 lg:px-2 lg:py-4 lg:mx-2">
                <amp-img class="contain" alt="Eyecatch" media="" layout="fill"
                    src="https://images-fe.ssl-images-amazon.com/images/I/51YzbphP0JL._SL160_.jpg">
                </amp-img>
            </div>
            <div class="p-4 flex flex-col justify-between leading-normal">
                <div class="px-1">
                    <p class="text-sm text-grey-dark flex items-center">TECH</p>
                    <p class="text-grey-dark">2016.08.13</p>
                    <div class="text-black text-xl mb-2">PythonでTF-IDFによる文書推薦</div>
                </div>
            </div>
            <a href="https://www.meganii.com/blog/2016/08/13/tf-idf-recommendation/" class="block absolute top-0 left-0 w-full h-full"></a>
        </article>
        
        <article class="m-4 pt-3 relative border-t border-grey-light rounded
        trasition opacity-100 hover:opacity-75 duration-200 hover:duration-200
        md:m-4 md:mx-auto
        lg:flex lg:my-4 lg:mx-auto">
            <div class="h-24 relative rounded lg:flex-none lg:w-1/5 lg:px-2 lg:py-4 lg:mx-2">
                <amp-img class="contain" alt="Eyecatch" media="" layout="fill"
                    src="https://images-fe.ssl-images-amazon.com/images/I/51%2BfZJOKEKL._SL160_.jpg">
                </amp-img>
            </div>
            <div class="p-4 flex flex-col justify-between leading-normal">
                <div class="px-1">
                    <p class="text-sm text-grey-dark flex items-center">TECH</p>
                    <p class="text-grey-dark">2016.08.12</p>
                    <div class="text-black text-xl mb-2">文書推薦</div>
                </div>
            </div>
            <a href="https://www.meganii.com/blog/2016/08/12/recommend-engine/" class="block absolute top-0 left-0 w-full h-full"></a>
        </article>
        
        <article class="m-4 pt-3 relative border-t border-grey-light rounded
        trasition opacity-100 hover:opacity-75 duration-200 hover:duration-200
        md:m-4 md:mx-auto
        lg:flex lg:my-4 lg:mx-auto">
            <div class="h-24 relative rounded lg:flex-none lg:w-1/5 lg:px-2 lg:py-4 lg:mx-2">
                <amp-img class="contain" alt="Eyecatch" media="" layout="fill"
                    src="https://images-fe.ssl-images-amazon.com/images/I/51%2BfZJOKEKL._SL160_.jpg">
                </amp-img>
            </div>
            <div class="p-4 flex flex-col justify-between leading-normal">
                <div class="px-1">
                    <p class="text-sm text-grey-dark flex items-center">TECH</p>
                    <p class="text-grey-dark">2016.08.11</p>
                    <div class="text-black text-xl mb-2">Hugoで関連記事を表示する方法</div>
                </div>
            </div>
            <a href="https://www.meganii.com/blog/2016/08/11/hugo-related-post/" class="block absolute top-0 left-0 w-full h-full"></a>
        </article>
        
        <article class="m-4 pt-3 relative border-t border-grey-light rounded
        trasition opacity-100 hover:opacity-75 duration-200 hover:duration-200
        md:m-4 md:mx-auto
        lg:flex lg:my-4 lg:mx-auto">
            <div class="h-24 relative rounded lg:flex-none lg:w-1/5 lg:px-2 lg:py-4 lg:mx-2">
                <amp-img class="contain" alt="Eyecatch" media="" layout="fill"
                    src="https://www.meganii.com/images/nopicture.png">
                </amp-img>
            </div>
            <div class="p-4 flex flex-col justify-between leading-normal">
                <div class="px-1">
                    <p class="text-sm text-grey-dark flex items-center">TECH</p>
                    <p class="text-grey-dark">2012.01.28</p>
                    <div class="text-black text-xl mb-2">短縮URLを展開する</div>
                </div>
            </div>
            <a href="https://www.meganii.com/blog/2012/01/28/1327735662/" class="block absolute top-0 left-0 w-full h-full"></a>
        </article>
        
        <article class="m-4 pt-3 relative border-t border-grey-light rounded
        trasition opacity-100 hover:opacity-75 duration-200 hover:duration-200
        md:m-4 md:mx-auto
        lg:flex lg:my-4 lg:mx-auto">
            <div class="h-24 relative rounded lg:flex-none lg:w-1/5 lg:px-2 lg:py-4 lg:mx-2">
                <amp-img class="contain" alt="Eyecatch" media="" layout="fill"
                    src="https://www.meganii.com/images/nopicture.png">
                </amp-img>
            </div>
            <div class="p-4 flex flex-col justify-between leading-normal">
                <div class="px-1">
                    <p class="text-sm text-grey-dark flex items-center">TECH</p>
                    <p class="text-grey-dark">2011.11.21</p>
                    <div class="text-black text-xl mb-2">Pythonのループの書き方いろいろ</div>
                </div>
            </div>
            <a href="https://www.meganii.com/blog/2011/11/21/1321884656/" class="block absolute top-0 left-0 w-full h-full"></a>
        </article>
        
        <article class="m-4 pt-3 relative border-t border-grey-light rounded
        trasition opacity-100 hover:opacity-75 duration-200 hover:duration-200
        md:m-4 md:mx-auto
        lg:flex lg:my-4 lg:mx-auto">
            <div class="h-24 relative rounded lg:flex-none lg:w-1/5 lg:px-2 lg:py-4 lg:mx-2">
                <amp-img class="contain" alt="Eyecatch" media="" layout="fill"
                    src="https://res.cloudinary.com/meganii/image/upload/c_scale,f_auto,q_auto,w_300/v1514031264/thumbnail_tech.png">
                </amp-img>
            </div>
            <div class="p-4 flex flex-col justify-between leading-normal">
                <div class="px-1">
                    <p class="text-sm text-grey-dark flex items-center">TECH</p>
                    <p class="text-grey-dark">2011.11.15</p>
                    <div class="text-black text-xl mb-2">Pythonでスクレイピングに挑戦。〜mixiの日記をEvernoteへ放り込みたい〜</div>
                </div>
            </div>
            <a href="https://www.meganii.com/blog/2011/11/15/1321370201/" class="block absolute top-0 left-0 w-full h-full"></a>
        </article>
        
        <article class="m-4 pt-3 relative border-t border-grey-light rounded
        trasition opacity-100 hover:opacity-75 duration-200 hover:duration-200
        md:m-4 md:mx-auto
        lg:flex lg:my-4 lg:mx-auto">
            <div class="h-24 relative rounded lg:flex-none lg:w-1/5 lg:px-2 lg:py-4 lg:mx-2">
                <amp-img class="contain" alt="Eyecatch" media="" layout="fill"
                    src="https://www.meganii.com/images/nopicture.png">
                </amp-img>
            </div>
            <div class="p-4 flex flex-col justify-between leading-normal">
                <div class="px-1">
                    <p class="text-sm text-grey-dark flex items-center">TECH</p>
                    <p class="text-grey-dark">2011.11.14</p>
                    <div class="text-black text-xl mb-2">いまさらだけど、Bot作る〜お天気取得〜</div>
                </div>
            </div>
            <a href="https://www.meganii.com/blog/2011/11/14/1321282662/" class="block absolute top-0 left-0 w-full h-full"></a>
        </article>
        
    </section>
    

</article>

    </main>
  </div><footer class="w-full border-t border-gray-200 p-4 bottom-0 bg-gray-200">
    <div class="lg:flex lg:mx-40">
        <div class="mt-2 lg:flex-none lg:w-2/5">
            <section>
                <article class="">
                    <h3 class="font-bold">Profile</h3>
                    <div class="flex">
                        <amp-img class="rounded" src="/images/meganii_logo.png" width="80" height="80" layout="fixed"></amp-img>
                        <div class="flex-1 ml-2">
                            <p>meganii(めがにい)</p>
                            <div class="">
                                <a href="https://twitter.com/meganii/" rel="noopener" target="_blank" class="inline-block p1" aria-label="Link to AMP HTML Twitter"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="22.2" viewbox="0 0 53 49"><title>Twitter</title><path d="M45 6.9c-1.6 1-3.3 1.6-5.2 2-1.5-1.6-3.6-2.6-5.9-2.6-4.5 0-8.2 3.7-8.2 8.3 0 .6.1 1.3.2 1.9-6.8-.4-12.8-3.7-16.8-8.7C8.4 9 8 10.5 8 12c0 2.8 1.4 5.4 3.6 6.9-1.3-.1-2.6-.5-3.7-1.1v.1c0 4 2.8 7.4 6.6 8.1-.7.2-1.5.3-2.2.3-.5 0-1 0-1.5-.1 1 3.3 4 5.7 7.6 5.7-2.8 2.2-6.3 3.6-10.2 3.6-.6 0-1.3-.1-1.9-.1 3.6 2.3 7.9 3.7 12.5 3.7 15.1 0 23.3-12.6 23.3-23.6 0-.3 0-.7-.1-1 1.6-1.2 3-2.7 4.1-4.3-1.4.6-3 1.1-4.7 1.3 1.7-1 3-2.7 3.6-4.6" class="ampstart-icon ampstart-icon-twitter"></path></svg></a>
                                <a href="https://www.facebook.com/meganiicom/" rel="noopener" target="_blank" class="inline-block p1" aria-label="Link to AMP HTML Facebook"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="23.6" viewbox="0 0 56 55"><title>Facebook</title><path d="M47.5 43c0 1.2-.9 2.1-2.1 2.1h-10V30h5.1l.8-5.9h-5.9v-3.7c0-1.7.5-2.9 3-2.9h3.1v-5.3c-.6 0-2.4-.2-4.6-.2-4.5 0-7.5 2.7-7.5 7.8v4.3h-5.1V30h5.1v15.1H10.7c-1.2 0-2.2-.9-2.2-2.1V8.3c0-1.2 1-2.2 2.2-2.2h34.7c1.2 0 2.1 1 2.1 2.2V43" class="ampstart-icon ampstart-icon-fb"></path></svg></a>
                                <a href="https://www.instagram.com/meganii/" rel="noopener" target="_blank" class="inline-block p1" aria-label="Link to AMP HTML Instagram"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewbox="0 0 54 54"><title>instagram</title><path d="M27.2 6.1c-5.1 0-5.8 0-7.8.1s-3.4.4-4.6.9c-1.2.5-2.3 1.1-3.3 2.2-1.1 1-1.7 2.1-2.2 3.3-.5 1.2-.8 2.6-.9 4.6-.1 2-.1 2.7-.1 7.8s0 5.8.1 7.8.4 3.4.9 4.6c.5 1.2 1.1 2.3 2.2 3.3 1 1.1 2.1 1.7 3.3 2.2 1.2.5 2.6.8 4.6.9 2 .1 2.7.1 7.8.1s5.8 0 7.8-.1 3.4-.4 4.6-.9c1.2-.5 2.3-1.1 3.3-2.2 1.1-1 1.7-2.1 2.2-3.3.5-1.2.8-2.6.9-4.6.1-2 .1-2.7.1-7.8s0-5.8-.1-7.8-.4-3.4-.9-4.6c-.5-1.2-1.1-2.3-2.2-3.3-1-1.1-2.1-1.7-3.3-2.2-1.2-.5-2.6-.8-4.6-.9-2-.1-2.7-.1-7.8-.1zm0 3.4c5 0 5.6 0 7.6.1 1.9.1 2.9.4 3.5.7.9.3 1.6.7 2.2 1.4.7.6 1.1 1.3 1.4 2.2.3.6.6 1.6.7 3.5.1 2 .1 2.6.1 7.6s0 5.6-.1 7.6c-.1 1.9-.4 2.9-.7 3.5-.3.9-.7 1.6-1.4 2.2-.7.7-1.3 1.1-2.2 1.4-.6.3-1.7.6-3.5.7-2 .1-2.6.1-7.6.1-5.1 0-5.7 0-7.7-.1-1.8-.1-2.9-.4-3.5-.7-.9-.3-1.5-.7-2.2-1.4-.7-.7-1.1-1.3-1.4-2.2-.3-.6-.6-1.7-.7-3.5 0-2-.1-2.6-.1-7.6 0-5.1.1-5.7.1-7.7.1-1.8.4-2.8.7-3.5.3-.9.7-1.5 1.4-2.2.7-.6 1.3-1.1 2.2-1.4.6-.3 1.6-.6 3.5-.7h7.7zm0 5.8c-5.4 0-9.7 4.3-9.7 9.7 0 5.4 4.3 9.7 9.7 9.7 5.4 0 9.7-4.3 9.7-9.7 0-5.4-4.3-9.7-9.7-9.7zm0 16c-3.5 0-6.3-2.8-6.3-6.3s2.8-6.3 6.3-6.3 6.3 2.8 6.3 6.3-2.8 6.3-6.3 6.3zm12.4-16.4c0 1.3-1.1 2.3-2.3 2.3-1.3 0-2.3-1-2.3-2.3 0-1.2 1-2.3 2.3-2.3 1.2 0 2.3 1.1 2.3 2.3z" class="ampstart-icon ampstart-icon-instagram"></path></svg></a>
                                
                            </div>
                        </div>
                    </div>
                    <div class="text-sm leading-relaxed mt-2">電機メーカーの社内SEとしてインフラ周りを担当しています🖥 DATA Saber目指してTableau勉強中。学んだことをTwitterやHugoのブログで発信しています(ブログメンタリングで週に1記事更新を目標)【興味分野】Azure / AWS / Tableau / SEO / AMP / Puppeteer / Flutter</div>
                </article>
            </section>
        </div>
        <div class="mt-2 lg:flex-none lg:w-2/5">
            
            <section class="">
                <h3 class="font-bold">Latest Posts</h4>
                
                <article class="relative m-4 pt-3 border-t border-grey-light rounded
                trasition opacity-100 hover:opacity-75 duration-200 hover:duration-200
                md:m-4 md:mx-auto
                lg:flex lg:my-4 lg:mx-auto">
                    <div class="h-24 relative rounded lg:flex-none lg:w-1/5 lg:px-2 lg:py-4 lg:mx-2">
                        <amp-img class="contain" alt="Eyecatch" media="" layout="fill"
                            src="https://res.cloudinary.com/meganii/image/upload/v1587899115/Blueprint-Subway_ja-JP_mh6xmb.png">
                        </amp-img>
                    </div>
                    <div class="p-4 flex flex-col justify-between leading-normal">
                        <div class="px-1">
                            <p class="uppercase text-sm text-grey-dark flex items-center">book</p>
                            <p class="text-grey-dark">2020.04.28</p>
                            <div class="text-black text-sm mb-2">「Tableau Blueprint」を読み進める上での用語整理</div>
                        </div>
                    </div>
                    <a href="https://www.meganii.com/blog/2020/04/28/organizing-the-terms-in-reading-tableau-blueprint/" class="block absolute top-0 left-0 w-full h-full"></a>
                </article>
                
                <article class="relative m-4 pt-3 border-t border-grey-light rounded
                trasition opacity-100 hover:opacity-75 duration-200 hover:duration-200
                md:m-4 md:mx-auto
                lg:flex lg:my-4 lg:mx-auto">
                    <div class="h-24 relative rounded lg:flex-none lg:w-1/5 lg:px-2 lg:py-4 lg:mx-2">
                        <amp-img class="contain" alt="Eyecatch" media="" layout="fill"
                            src="https://res.cloudinary.com/meganii/image/upload/c_scale,f_auto,q_auto,w_600/v1587879130/delta-practice_xyfyxj.jpg">
                        </amp-img>
                    </div>
                    <div class="p-4 flex flex-col justify-between leading-normal">
                        <div class="px-1">
                            <p class="uppercase text-sm text-grey-dark flex items-center">book</p>
                            <p class="text-grey-dark">2020.04.27</p>
                            <div class="text-black text-sm mb-2">「デルタ状の実践」〜「やること地獄」を終わらせるタスク管理「超」入門〜</div>
                        </div>
                    </div>
                    <a href="https://www.meganii.com/blog/2020/04/27/introduction-to-task-management/" class="block absolute top-0 left-0 w-full h-full"></a>
                </article>
                
                <article class="relative m-4 pt-3 border-t border-grey-light rounded
                trasition opacity-100 hover:opacity-75 duration-200 hover:duration-200
                md:m-4 md:mx-auto
                lg:flex lg:my-4 lg:mx-auto">
                    <div class="h-24 relative rounded lg:flex-none lg:w-1/5 lg:px-2 lg:py-4 lg:mx-2">
                        <amp-img class="contain" alt="Eyecatch" media="" layout="fill"
                            src="https://res.cloudinary.com/meganii/image/upload/c_scale,f_auto,q_auto,w_300/v1514031264/thumbnail_tech.png">
                        </amp-img>
                    </div>
                    <div class="p-4 flex flex-col justify-between leading-normal">
                        <div class="px-1">
                            <p class="uppercase text-sm text-grey-dark flex items-center">tech</p>
                            <p class="text-grey-dark">2020.04.20</p>
                            <div class="text-black text-sm mb-2">Puppeteerを使ってQrunchへクロス投稿する</div>
                        </div>
                    </div>
                    <a href="https://www.meganii.com/blog/2020/04/20/blog-cross-posting-to-qrunch-automatically-by-puppeteer/" class="block absolute top-0 left-0 w-full h-full"></a>
                </article>
                
                <article class="relative m-4 pt-3 border-t border-grey-light rounded
                trasition opacity-100 hover:opacity-75 duration-200 hover:duration-200
                md:m-4 md:mx-auto
                lg:flex lg:my-4 lg:mx-auto">
                    <div class="h-24 relative rounded lg:flex-none lg:w-1/5 lg:px-2 lg:py-4 lg:mx-2">
                        <amp-img class="contain" alt="Eyecatch" media="" layout="fill"
                            src="https://res.cloudinary.com/meganii/image/upload/c_scale,f_auto,q_auto,w_300/v1514031264/thumbnail_tech.png">
                        </amp-img>
                    </div>
                    <div class="p-4 flex flex-col justify-between leading-normal">
                        <div class="px-1">
                            <p class="uppercase text-sm text-grey-dark flex items-center">tech</p>
                            <p class="text-grey-dark">2020.04.17</p>
                            <div class="text-black text-sm mb-2">Bitlyでの短縮URL作成（v3からv4への移行）</div>
                        </div>
                    </div>
                    <a href="https://www.meganii.com/blog/2020/04/17/bitly-api-migrating-from-v3/" class="block absolute top-0 left-0 w-full h-full"></a>
                </article>
                
                <article class="relative m-4 pt-3 border-t border-grey-light rounded
                trasition opacity-100 hover:opacity-75 duration-200 hover:duration-200
                md:m-4 md:mx-auto
                lg:flex lg:my-4 lg:mx-auto">
                    <div class="h-24 relative rounded lg:flex-none lg:w-1/5 lg:px-2 lg:py-4 lg:mx-2">
                        <amp-img class="contain" alt="Eyecatch" media="" layout="fill"
                            src="https://res.cloudinary.com/meganii/image/upload/c_scale,f_auto,q_auto,w_300/v1514031264/thumbnail_tech.png">
                        </amp-img>
                    </div>
                    <div class="p-4 flex flex-col justify-between leading-normal">
                        <div class="px-1">
                            <p class="uppercase text-sm text-grey-dark flex items-center">tech</p>
                            <p class="text-grey-dark">2020.04.10</p>
                            <div class="text-black text-sm mb-2">Blog KPI Collector（GAS）で各種KPIを自動取得する</div>
                        </div>
                    </div>
                    <a href="https://www.meganii.com/blog/2020/04/10/collecting-blog-kpi-with-google-apps-script-blog-kpi-collector/" class="block absolute top-0 left-0 w-full h-full"></a>
                </article>
                
            </section>

        </div>
        <div class="mt-2 lg:flex-none lg:w-1/5">
            <section>
                <h3 class="font-bold">Category</h3>
                
                
                <a class="ml-2 mt-2 block hover:text-grey-200" href="https://www.meganii.com/category/tech/">Tech</a>
                
                <a class="ml-2 mt-2 block hover:text-grey-200" href="https://www.meganii.com/category/life/">Life</a>
                
                <a class="ml-2 mt-2 block hover:text-grey-200" href="https://www.meganii.com/category/activity/">Activity</a>
                
                <a class="ml-2 mt-2 block hover:text-grey-200" href="https://www.meganii.com/category/travel/">Travel</a>
                
                <a class="ml-2 mt-2 block hover:text-grey-200" href="https://www.meganii.com/category/stationery/">Stationery</a>
                
                <a class="ml-2 mt-2 block hover:text-grey-200" href="https://www.meganii.com/category/book/">Book</a>
                
            </section>
            <section class="mt-2 p-1">
                <h3 class="font-bold">Tags</h3>
                
                <a class="" href="https://www.meganii.com/tags/%E8%AA%AD%E6%9B%B8/">読書(46)</a>
                
                <a class="" href="https://www.meganii.com/tags/think/">Think(34)</a>
                
                <a class="" href="https://www.meganii.com/tags/%E5%8B%89%E5%BC%B7%E4%BC%9A/">勉強会(29)</a>
                
                <a class="" href="https://www.meganii.com/tags/%E5%B0%B1%E6%B4%BB/">就活(26)</a>
                
                <a class="" href="https://www.meganii.com/tags/hugo/">Hugo(25)</a>
                
                <a class="" href="https://www.meganii.com/tags/book/">book(25)</a>
                
                <a class="" href="https://www.meganii.com/tags/blog/">Blog(20)</a>
                
                <a class="" href="https://www.meganii.com/tags/ruby/">Ruby(20)</a>
                
                <a class="" href="https://www.meganii.com/tags/jekyll/">jekyll(16)</a>
                
                <a class="" href="https://www.meganii.com/tags/%E7%A0%94%E7%A9%B6/">研究(15)</a>
                
                <a class="" href="https://www.meganii.com/tags/javascript/">JavaScript(14)</a>
                
                <a class="" href="https://www.meganii.com/tags/programming/">Programming(13)</a>
                
                <a class="" href="https://www.meganii.com/tags/lifehack/">Lifehack(11)</a>
                
                <a class="" href="https://www.meganii.com/tags/event/">event(11)</a>
                
                <a class="" href="https://www.meganii.com/tags/evernote/">Evernote(10)</a>
                
                <a class="" href="https://www.meganii.com/tags/tableau/">Tableau(10)</a>
                
                <a class="" href="https://www.meganii.com/tags/%E5%90%8D%E5%A4%A7/">名大(10)</a>
                
                <a class="" href="https://www.meganii.com/tags/%E3%83%95%E3%82%A1%E3%82%B7%E3%83%AA%E3%83%86%E3%83%BC%E3%82%B7%E3%83%A7%E3%83%B3/">ファシリテーション(9)</a>
                
                <a class="" href="https://www.meganii.com/tags/python/">Python(9)</a>
                
                <a class="" href="https://www.meganii.com/tags/%E3%83%87%E3%83%96%E3%82%B5%E3%83%9F/">デブサミ(9)</a>
                
                <a class="" href="https://www.meganii.com/tags/%E6%97%85%E8%A1%8C%E8%A8%98/">旅行記(9)</a>
                
                <a class="" href="https://www.meganii.com/tags/mac/">Mac(9)</a>
                
                <a class="" href="https://www.meganii.com/tags/meetup/">Meetup(8)</a>
                
                <a class="" href="https://www.meganii.com/tags/java/">Java(8)</a>
                
                <a class="" href="https://www.meganii.com/tags/%E5%90%8D%E5%8F%A4%E5%B1%8B/">名古屋(8)</a>
                
                <a class="" href="https://www.meganii.com/tags/ubuntu/">Ubuntu(8)</a>
                
                <a class="" href="https://www.meganii.com/tags/%E5%A4%A7%E9%98%AA/">大阪(8)</a>
                
                <a class="" href="https://www.meganii.com/tags/design/">Design(7)</a>
                
                <a class="" href="https://www.meganii.com/tags/%E3%82%AD%E3%83%A3%E3%83%AA%E3%82%A2/">キャリア(7)</a>
                
                <a class="" href="https://www.meganii.com/tags/english/">English(7)</a>
                
                <a class="" href="https://www.meganii.com/tags/movie/">movie(6)</a>
                
                <a class="" href="https://www.meganii.com/tags/electron/">Electron(6)</a>
                
                <a class="" href="https://www.meganii.com/tags/db/">DB(6)</a>
                
                <a class="" href="https://www.meganii.com/tags/travel/">travel(6)</a>
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
                
            </section>
        </div>
    </div>
    <div class="text-xs text-gray-400 text-center">
        <p>made with <a href="https://gohugo.io" class="underline hover:text-blue-400">Hugo</a> and <a href="https://tailwindcss.com" class="underline hover:text-blue-400">TailwindCSS</a></p>
    </div>
</footer><amp-install-serviceworker
    src="https://www.meganii.com/sw.js"
    data-iframe-src="https://www.meganii.com/install-sw.html"
    layout="nodisplay">
</amp-install-serviceworker></body>
</html>